Impresora Fiscal
                                                Compañía Hasar SAIC
                                      Manual de comandos fiscales
                                                 Impresoras modelos
                                                           SMH/P-615F
                                                          SMH/P-PR4F
                                                           SMH/P-930F
                                                           SMH/P-951F
                          Comunicación a través del puerto serie
file:///E|/roberto/SERITICK.htm (1 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
1. Descripción general
    1.1. Comunicaciones con el
    host
    1.2. Memoria fiscal
    1.3. Acumuladores
    1.4. Bloqueos
    1.5. Corte en la alimentación
    eléctrica
2. Comandos Fiscales
    2.1. Estructura de los comandos
    2.2. Campos de los comandos
          2.2.1.Tipos de datos y
          abreviaturas
          2.2.2. Longitud de los
          campos
          2.2.3. Campos vacíos
          2.2.4. Campos de montos
          2.2.5. Cantidades
          2.2.6. Campos con texto
    2.3. Clasificación de los
    comandos
3. Descripción de los comandos
    3.1. FormatEprom - Comando de
    formateo
    3.2. Comandos de ínicialización, baja y
    configuración
          3.2.1. InitEpromFiscal -
          Inicialización
          3.2.2. KillEpromFiscal - Baja de la memoria
          fiscal
          3.2.3. ConfigureControllerByBlock - Configuración del controlador en
          bloque
          3.2.4. ConfigureControllerByOne - Config. del controlador por
          parámetros
          3.2.5. ChangeIVA Responsability - Cambio de responsabilidad frente al
          IVA
    3.3. Comandos de diagnóstico y
 file:///E|/roberto/SERITICK.htm (2 of 101) [8/8/01 15:07:22]
Impresora Fiscal
   consulta
         3.3.1. StatusRequest - Consulta de
         estado
         3.3.2. GetConfigurationData - Consulta de
         configuración
         3.3.3. GetInitData - Consulta de datos de
         inicialización
   3.4. Comandos de control
   fiscal
         3.4.1. HistoryCapacity - Capacidad
         restante
         3.4.2 DailyClose - Cierre de jornada
         fiscal
         3.4.3. DailyCloseByDate - Reporte de auditoria por
         fechas
         3.4.4. DailyCloseByNumber - Reporte de auditoria por número de
         Z
         3.4.5. GetDailyReport - Reporte de registro
         diario
         3.4.6. GetWorkingMemory - Consulta de memoria
         RAM
         3.4.7. SendFirstIVA - Iniciar información de
         IVA
         3.4.8. NextIVATransmission - Continuar información de
         IVA
   3.5. Comandos de comprobante
   fiscal
         3.5.1. OpenFiscalReceipt - Abrir comprobante
         fiscal
         3.5.2. PrintFiscalText - Imprimir texto
         fiscal
         3.5.3. PrintLineItem - Imprimir
         ítem
         3.5.4. LastItemDiscount - Descuento sobre último ítem
         vendido
         3.5.5. GeneralDiscount - Descuento
         general
         3.5.6. ReturnRecharge - Devolución de envases, Bonificaciones y
         Recargos
         3.5.7. ChargeNonRegisteredTax - Recargo IVA a Responsable no
         Inscripto
         3.5.8. Perceptions -
file:///E|/roberto/SERITICK.htm (3 of 101) [8/8/01 15:07:22]
Impresora Fiscal
         Percepciones
         3.5.9. Subtotal
         3.5.9. TotalTender - Total
         3.5.10. CloseFiscalReceipt - Cerrar comprobante
         fiscal
   3.6. Comandos de comprobante no-
   fiscal
         3.6.1. OpenNonFiscalReceipt - Abrir comprobante no-
         fiscal
         3.6.2. OpenNonFiscalSlip - Abrir comprobante no-fiscal en impresora
         slip
         3.6.3. PrintNonFiscalText - Imprimir texto no-
         fiscal
         3.6.4. CloseNonFiscalReceipt - Cerrar comprobante no-
         fiscal
         3.6.5. CutNonFiscalReceipt - Cortar comprobante no-
         fiscal
         3.6.6. DNFHFarmacias - Documento no fiscal homologado
         farmacias
         3.6.7. DNFHReparto - Documento no fiscal homologado
         reparto
         3.6.8. SetVoucherData1 - Datos del voucher de tarjeta de crédito
         1
         3.6.9. SetVoucherData2 - Datos del voucher de tarjeta de crédito
         2
         3.6.10. PrintVoucher - Imprimir
         voucher
   3.7. Comando de código de
   barras
         3.7.1 BarCode - Código de
         barras
   3.8. Comandos de control de la
   impresora
         3.8.1 FeedReceipt - Avanzar papel de
         tickets
         3.8.2 FeedJournal - Avanzar papel cinta de
         auditoría
         3.8.3 FeedReceiptJournal - Avanzar papeles de tickets y cinta de
         auditoría
   3.9. Comandos de fecha, hora, encabezamiento y cola de
   documentos
         3.9.1. SetDateTime - Ingresar fecha y
file:///E|/roberto/SERITICK.htm (4 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
          hora
          3.9.2. GetDateTime - Consultar fecha y
          hora
          3.9.3. SetHeaderTrailer - Programar texto de encabezamiento y cola de tickets y
          documentos no fiscales
          3.9.4. GetHeaderTrailer - Consultar texto de encabezamiento y cola del
          ticket
          3.9.5. SetCustomerData - Datos comprador ticket-
          factura
          3.9.6. SetFantasyName - Programar texto del nombre de fantasía del
          propietario
    3.10. Comandos de cajón de
    dinero
          3.10.1 OpenDrawer - Abrir
          cajón
    3.11. Comando de display
          3.11.1. Estructura del display de
          cliente
          3.11.2. Escritura en el display
          3.11.3. WriteDisplay - Escribir en
          display
    3.12. Comandos para uso de la
    DGI
          3.12.1. DGICommandProcessor - Procesador de comandos
          DGI
          3.12.2. DGIRequestByDate - Reporte de auditoría DGI por
          fechas
          3.12.3. DGIRequestByZNumber - Reporte de auditoria DGI por
          Z
          3.12.4. KillEprom - Comando de baja del controlador
          fiscal
4. Documentos
    4.1. Ticket
    4.2. Ticket-factura
Apéndices
    Apéndice 1: Tipo de letra.
    Apéndice 2: Status fiscal
    Apéndice 3: Status impresora
    Apéndice 4: Status auxiliar
    Apéndice 5: Manejo del IVA
 file:///E|/roberto/SERITICK.htm (5 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
          5.1. Estructura de la tabla de IVA
          5.2. Impuestos internos
          5.3. Cálculo del monto del IVA en los descuentos sobre el
          subtotal
          5.4. Impresión de las líneas correspondientes a descuentos (o
          recargos)                                    102
    Apéndice 6: Características de la comunicación Host-Controlador
    fiscal                                        103
1. Descripción general
Las impresoras HASAR modelos SMH/P-615F, SMH/P-PR4F, SMH/P-930F y SMH/P-951F
son impresoras fiscales que cumplen con las especificaciones de la Resolución General de la
DGI No 4.104.
Estaciones de impresión
La impresora SMH/P-615F posee una estación de impresión por impacto con papel copiativo
químico, emtiendo un original para el ticket y copia para la cinta de auditoría (cinta de papel
de 40 caracteres de ancho en modo normal y 20 caracteres en modo expandido). Las
impresoras SMH/P-PR4F, SMH/P-930F y SMH/P-951F poseen tres estaciones de impresión
por impacto: de tickets y de cinta de auditoría (cinta de papel de 40 caracteres de ancho en
modo normal y 20 caracteres en modo expandido) y una tercera para validación de
documentos (impresora slip de 80 caracteres de ancho en modo normal y 40 caracteres en
modo expandido).
Acceso al interior de las impresoras
El acceso a las partes interiores de la impresora se realiza de dos maneras:
         - Las partes mecánicas que requieren service de mantenimiento (cabezal de impresión,
         troquelador, etc) y renovación de insumos (cinta de impresión, papel) son directamente
         accesibles desde el exterior abriendo las tapas ad-hoc en la carcasa plástica.
         - La sección que contiene la electrónica se encuentra cerrada con precinto, y para
         acceder a ella es necesario romper el mismo. La sección de electrónica fiscal contiene el
         circuto controlador fiscal y la EPROM fiscal donde se almacenan los registros diarios. La
         sección de electrónica no-fiscal puede contiene el circuito controlador del aparato
         impresor.
Comunicaciones
Sólo el circuito controlador fiscal puede recibir comunicaciones (comandos) del exterior. El
circuito controlador de impresora se encuentra comunicado con el controlador fiscal a través
de una línea serie, de manera que cualquier comunicación dirigida a la impresora debe
procesarse en el circuito controlador fiscal antes de ser ejecutada. La comunicación responde
 file:///E|/roberto/SERITICK.htm (6 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
a un esquema Master-Slave puro; es decir, ningún dispositivo puede tomar control del vínculo
por iniciativa propia.
El circuito controlador fiscal posee dos puertos de comunicación serie:
• Conexión de un host (indicado con la leyenda HOST). A este puerto se conecta el host en el
que reside el programa de caja. El puerto cuenta con dos conectores en paralelo: a. DB-25
(ver características en el apéndice 5). b. tipo mini-DIN, para conectar un host de Compañia
Hasar.
• Conexión de un aparato recolector de datos (indicado con la leyenda DGI). Es de uso
exclusivo de la autoridad fiscal y no puede usárselo para ninguna función excepto las
especialmente descriptas en la resolución arriba mencionada. Cumple con los requisitos
mencionados en la Resolución Fiscal No 4.104
Modos de funcionamiento (entrenamiento y fiscal)
La impresora posee dos modos de funcionamiento: modo entrenamiento y modo fiscal. Una
vez formateada la EPROM fiscal, la impresora queda en modo entrenamiento. Este modo
difiere del fiscal en los siguientes puntos:
          • Los tickets llevan la leyenda “NO FISCAL” cada 5 líneas, no llevan el logotipo fiscal y
          los espacios en blanco se encuentran llenos con el caracter “?”. Además, no llevan el
          encabezamiento con los datos correspondientes a propietario, etc.
          • Si bien se puede emitir el comando de cierre diario, los datos almacenados en la
          memoria diaria no son volcados a la EPROM fiscal.
          • Se encuentra disponible un comando para inicializar la EPROM fiscal. Una vez emitido
          este comando, la impresora pasa a modo fiscal, y no podrá retornar a modo no-fiscal.
          Este comando no es público y sólo es usado por Compañía Hasar y su red de Servicios
          Técnicos Autorizados.
1.1. Comunicaciones con el host
El protocolo de comunicación entre el host en el que reside el programa de caja y el
controlador fiscal es un vínculo asincrónico, half duplex, según norma RS-232C. La relación
entre host y controlador es del tipo Master-Slave.
Los comandos y respuestas intercambiados se encuentran empaquetados, tal como se
describe en las próximas páginas. El esquema de comunicación es el siguiente.
                Host (master)                               Controlador fiscal (slave)
                Paquete A →
                                 ← NAK
                Paquete A →
                                 ← ACK
                                 ← DC2 o DC4
  file:///E|/roberto/SERITICK.htm (7 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
                                ←                   Respuesta A
                         NAK →
                                ←                   Respuesta A
                         ACK →
               Paquete B →
                                ←                   ACK
                                ←                   Respuesta B
                         ACK →
      - Cada vez que el controlador recibe un paquete del host, responde con un ACK (06H) en
      caso de que la transmisón se haya realizado sin errores, o con un NAK (15H) en caso de
      que haya habido errores. De manera similar, cuando el host recibe un paquete del
      controlador fiscal (en el esquema superior se lo indica como respuesta), responde con un
      ACK o un NAK.
      - Si, tras enviar un paquete, el host recibe un NAK del controlador, reenvía el paquete.
      - Si un paquete es recibido correctamente por el controlador, tras responder con un ACK
      se dedica a ejecutar el comando.
      - Algunos comandos requieren de períodos de tiempo extendido para completarse. En
      estos casos el controlador envía cada 500ms el código DC2 (12H) para indicar que el
      comando se encuentra aún activo. Si falta papel en alguna de las estaciones de
      impresión, el controlador envía el código DC4 (14H). En caso de recibir uno de esteos
      códigos, el host debe continuar esperando la respuesta.
      - Una vez ejecutado el comando, el controlador envía al host el paquete de respuesta.
      - Si el host recibe el paquete con errores, responde al controlador con NAK y se perpara
      para volver a recibir el paquete. Al recibir el NAK, el controlador vuelve a enviar el
      paquete.
      - Si el host recibe el paquete correctamente, envía un ACK al controlador. El host queda
      entonces habilitado para transmitir el próximo paquete.
      - El host tiene un timeout de 1 segundo para recibir el primer byte de una respuesta del
      controlador fiscal. Pasado este tiempo, el host retransmite al controlador el último
      mensaje enviado.
Las siguientes situaciones corresponden a errores en el uso del protocolo, por lo que sólo
pueden presentarse en un ambiente de desarrollo.
      - El buffer del controlador fiscal en el que se almacenan los comandos recibidos del host
      tiene una tamaño tal que un comando ocupa menos del 75% de su capacidad. En el caso
      de que, por error, se envíe un comando que supere este 75%, el controlador enviará al
      host, como advertencia, el código DC3 (13H). De forma inversa, la transmisión de
      mensajes desde el controlador puede habilitarse o deshabilitarse desde el host. Si el host
      envía el código DC3, el controlador quedará deshabilitado para transmitir. La transmisión
 file:///E|/roberto/SERITICK.htm (8 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
      volverá a habilitarse cuando el host envíe el código DC1 (11H).
      - Cada vez que el controlador envía una respuesta, espera que el host responda con ACK
      o NAK. Si el host no lo hace, el controlador proseguirá intentando reenviar la respuesta,
      con lo que la comunicación quedará bloqueada. Para salir de esta situación basta con
      enviar desde el host el ACK o NAK omitido.
1.2. Memoria fiscal
El controlador fiscal cuenta con una EPROM que se encuentra inmersa en un habitáculo
relleno con resina epoxi que forma parte solidaria de la carcaza.
La EPROM solo puede ser accedida mediante el controlador fiscal (tanto para escritura como
para lectura). Cada vez que se energiza la impresora el controlador fiscal comprueba la
consistencia de los datos de la memoria EPROM. Esta puede encontrarse en alguno de los
siguientes estados:
         • Sin formatear
             Según el uso que se vaya a dar a la placa fiscal, las memorias fiscales pueden salir de
         fábrica formateas o sin formatear. Cuando se alimenta un equipo con la memoria
         EPROM sin formatear, la impresora imprime el siguiente mensaje “Eprom sin
         formatear”. En este estado es imposible proseguir hasta tanto no se formatee la EPROM
         mediante el comando descripto más adelante en este manual.
         • Sin inicializar
             Todas las memorias fiscales salen de fabrica sin incializar. Cuando se alimenta un
         equipo con la memoria EPROM sin inicializar, se imprime el siguiente mensaje “Eprom
         sin inicializar”. En este estado la impresora sólo puede operar en modo entrenamiento.
         Para ingresar en el modo fiscal debe emitirse el comando InitEpromFiscal.
         • Inicializada
             Una EPROM inicializada puede presentar dos estados según la consistencia de sus
         datos:
               • Datos consistentes.
                  El equipo está listo para operar normalmente.
               • Datos inconsistentes
                  Si los datos no son consistentes (por habérse cambiado la EPROM u otro motivo),
               el controlador fiscal se bloquea y sólo puede salirse de esta condición accediendo
               físicamente al circuito impreso y realizando un MAC. Este procedimiento sólo puede
               ser realizado por Compañía Hasar o algunos de sus services autorizados.
                  Cuando se alimenta un equipo con la memoria EPROM bloqueada, se imprime el
               siguiente mensaje “Controlador fiscal bloqueado”. En este estado es imposible
               proseguir operando hasta tanto no se lo desbloquee.
 file:///E|/roberto/SERITICK.htm (9 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
En memoria EPROM se guardan:
   • Datos referidos al propietario del controlador, al propio controlador y a la fecha de
   inicialización. Estos datos se graban mediante el comando InitEpromFiscal y son:
      - El número de CUIT del propietario, previo chequeo de su consistencia.
      - La razón social del propietario.
      - El número de registro de la impresora.
      - La fecha de inicialización.
      - El número del punto de venta.
      - La fecha de inicio de actividades del propietario.
      - El número de inscripción en Ingresos Brutos.
          - La responsabilidad frente al IVA del propietario (puede cambiarse hasta 5 veces
          mediante un comando reservado para uso de Compañía Hasar).
   • Datos referidos a las ventas diarias, a los comprobantes emitidos y a las veces que el
   controlador fiscal quedó bloqueado. Estos datos se almacenan en forma de registros
   diarios. La memoria tiene capacidad para 1850 registros y cada uno de los registros se
   graba mediante el comando DailyClose (Z). Los datos almacenados en cada registro diario
   son:
      - Fecha.
      - Total de ventas de la jornada fiscal.
      - Total de IVA de la jornada fiscal.
      - Número del último ticket / ticket-factura B/C emitido durante la jornada fiscal.
          - Número del último ticket-factura A emitido.
      - Cantidad de comprobantes cancelados durante la jornada fiscal.
      - Número de Z con que se cerró la jornada fiscal.
      - Cantidad de veces que el controlador quedó bloqueado durante la jornada               fiscal.
      - Total de Impuestos internos de la jornada fiscal.
   • Registro relativo a la baja del controlador fiscal. Este es un registro que se llena cuando el
   controlador es dado de baja por la autoridad fiscal mediante el comando KillEpromFiscal.
   Una vez que se ha llenado este registro la EPROM no puede volver a utilizarse y debe ser
   cambiada, aunque sí pueden seguirse leyendo los datos almacenados en ella.
1.3. Acumuladores
Durante la operación, el controlador fiscal mantiene en memoria RAM una serie de
acumuladores con los datos de ventas, tickets, reportes, etc., que se producen durante la
jornada fiscal. Estos acumuladores son actualizados al ejecutarse determinados comandos y,
al cierre de la jornada fiscal, los valores almacenados en algunos de ellos son grabados en la
memoria EPROM, mientras que otros son reseteados a cero.
  file:///E|/roberto/SERITICK.htm (10 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
La memoria RAM tiene backup de batería que le permite guardar los datos durante un
período de 60 días. Cada vez que se energiza la impresora el controlador fiscal comprueba la
consistencia de los datos de la memoria RAM. Si estos no son consistentes, el controlador
fiscal se bloquea y sólo puede salirse de esta condición accediendo físicamente al circuito
impreso y realizando un MAC (es decir, es necesario romper el precinto fiscal). Este
procedimiento sólo puede ser realizado por Compañía Hasar o algunos de sus services
autorizados.
1.4. Bloqueos
El controlador fiscal se bloquea como consecuencia de falta de consistencia en la memoria
EPROM fiscal o en la memoria RAM de trabajo.
Al prenderse un controlador fiscal bloqueado por falta de consistencia en la memoria,
automáticamente se imprimen dos líneas con las leyendas “Cont. fiscal bloqueado” y “Error
en firma de RAM”. La impresora debe ser desbloqueada antes de poder operársela. Para
ello debe accederse físicamente al circuito del controlador fiscal, es decir, se debe romper el
precinto fiscal, y realizar un MAC. Este procedimiento sólo puede ser realizado por Compañía
Hasar o algunos de sus services autorizados.
El proceso de recuperación de un bloqueo produce:
   - La pérdida de datos existentes en la memoria RAM de trabajo.
   - El incremento en 1 del contador del registro de bloqueos existente en la memoria EPROM
   fiscal.
    - La impresión de la leyenda “MAC EN PROCESO.
- La leyenda “Inicio de operación fiscal”.
Una vez finalizado el proceso la impresora queda lista para operar normalmente.
1.5. Corte en la alimentación eléctrica
Toda vez que el controlador es alimentado, éste verifica la consistencia de las memorias de
trabajo y fiscal.
Cada vez que se confecciona un comprobante (fiscal o no fiscal) el controlador almacena en
un buffer todos los comandos recibidos. Una vez cerrado el comprobante, este buffer es
vaciado.
En caso de producirse un corte en la alimentación eléctrica con un comprobante abierto el
controlador fiscal cancela dicho comprobante. Al retornar la alimentación imprime dos líneas,
la primera formada por el caracter “/” y la segunda con la leyenda “CORTE DE CORRIENTE”,
seguidas de la leyenda “COMPROBANTE CANCELADO”. A continuación consulta el buffer
  file:///E|/roberto/SERITICK.htm (11 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
arriba mencionado y ejecuta automáticamente, sin intervención del operador, todos los
comandos almacenados, restableciéndose así el estado en que se encontraba el
comprobante.
La cancelación se realiza en todos los estados del controlador excepto:
     • Si se estaba imprimiendo el logotipo fiscal de un comprobante fiscal, una vez recuperada
     la energía el comprobante no se cancela y se vuelve a imprimir el logo fiscal.
     • Si se estaban imprimindo las dos primeras líneas del encabezado del ticket, una vez
     recuperada la energía las líneas se completan automáticamente.
     • Si se estaba realizando un cierre de jornada fiscal, una vez recuperada la energía el
     comando no es cancelado y se completa automáticamente.
En todos los casos se imprime la leyenda relativa al corte de corriente.
2. Comandos Fiscales
2.1. Estructura de los comandos
Los comandos fiscales usados para comunicación entre la impresora fiscal y el host (PC,
ECR, etc.) deben responder al siguiente formato:
STX SN               Comando           FS       Texto        FS    Texto ............... ETX BCC
Donde:
Cant. Bytes               Descripción
STX                                        1                   Start of Frame (ASCII 02H)
SN                                        1                   Sequence number. Un número par entre 20H
                                                               y 7fH que identifica el paquete enviado. El
                                                                  SN del paquete siguiente debe continuar la
                                                                  secuencia, y una vez alcanzado 7fH se
                                                                      comienza nuevamente por 20H. La
respuesta                                                                 debe tener el mismo SN.
Comando                                1                  Código del comando
FS                                    1                  Field Separator (ASCII 1cH)
Texto                                 n                   Texto a imprimir en la impresora fiscal
               (Los campos FS y Texto pueden repetirse varias veces de acuerdo
al tipo de comando envíado.)
ETX                                        1                   End of Frame (ASCII 03H)
BCC                                        4                   Block Check Character: Se obtiene
                                                                             sumando todos los campos anteriores.
 file:///E|/roberto/SERITICK.htm (12 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
2.2. Campos de los comandos
2.2.1.Tipos de datos y abreviaturas
En las descripciones de los comandos se han utilizado las siguientes abreviaturas en el tipo
de datos que contiene los campos:
H Hexadecimal
      Con la excepción de los textos fiscales, todos los campos de mensajes intercambiados
      entre host y controlador fiscal están formados por datos ASCII de 7 bits. Si el campo
      requiere de 8 bits, se lo representa como pares ASCII hexadecimales. Los caracteres
      hexadecimales ASCII validos son del rango 20 a 7f.
A Alfanumérico
      Consiste de los caracteres con códigos ASCII 32 - 175.
N Numérico
      Consiste de los dígitos ASCII 0 - 9 y del punto decimal, precedidos del signo postivo o
      negativo. Los números sin signo son considerados positivos. Los ceros a la izquierda
      pueden ser omitidos.
D Fecha (AAMMDD)
      AA puede estar en el rango 00 - 99, con 99 representando al año 1999 y 00 al año 2000.
      MM puede estar en el rango 1 - 12 y DD en el rango 1 - 31. Los ceros a la izquierda
      pueden omitirse en el campo de los años, pero no pueden omitirse en el campo de los
      meses ni en el de los días.
T Hora (HHMMSS)
      HH puede estar en el rango 0 - 23, MM en el rango 0 - 59 y SS en el rango 0 - 59. Los
      ceros a la izquierda pueden omtirse en el campo de las horas pero no en el de los minutos
      ni en el de los segundos.
Si se recibe un comando con el tipo erróneo de datos para un determinado campo, se
responde con un error de campo en el status fiscal (ver apéndice 2) y el comando es
ignorado por el controlador fiscal.
2.2.2. Longitud de los campos
Los campos son de longitud variable. En la descripción de los comandos se indica el tamaño
máximo de los mismos, pero dicho tamaño puede reducirse si el dato a transcribir tiene
menor longitud.
2.2.3. Campos vacíos
  file:///E|/roberto/SERITICK.htm (13 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
Si un campo se encuentra vacío, puede eliminárselo. Aún así, deben conservarse los
separadores de campo al comienzo y al final del campo eliminado.
2.2.4. Campos de montos
Los campos que contienen montos son numéricos y están indicados en la forma
                         ±nnnnnnn.nn
donde
                      ±                      indica el signo (si éste es positivo, puede eliminárselo). Si el
                      campo no lleva indicación de signo, el número no debe signarse.
                      nnnnnnn                 indica que el campo tiene una parte entera de tantos dígitos
                      como n se indican (en este caso, 7 dígitos)
                      .                      indica el punto decimal, que debe ir obligatoriamente
                      nn                     indica que el campo tiene una parte decimal de tantos dígitos
                      como n se indican (en este caso, 2 dígitos)
Los campos de montos son de longitud variable. Si el monto es positivo, puede omitirse el
signo más. En caso de que la parte entera tenga menos dígitos que el máximo permitido, no
es necesario llenar el campo con ceros a la izquierda. En cuanto a los decimales, aún en el
caso de que se trate de números enteros o con menos decimales que los indicados, debe
respetarse el formato y llenarse con ceros los espacios decimales no usados.
2.2.5. Cantidades
El campo de los montos correspondiente a las cantidades tiene un formato con 10 decimales
con las siguientes características.
         - No es necesario llenar llenar los diez lugares decimales.
         - En los documentos sólo se imprimen los tres decimales más significativos.
Debido a lo anterior y al procedimiento de redondeo, es posible que, en el caso de productos
pesables, el resultado de multiplicar la cantidad (el peso) impreso en el ticket por el valor
unitario del artículo difiera en algún decimal con el valor de la venta impreso en el mismo
ticket.
El uso de cantidades (pesos) con 10 decimales es una respuesta a la cantidad y variedad de
balanzas de distintas características existentes en plaza y, de acuerdo a la experiencia
recogida por Compañía Hasar, resulta la solución más satisfactoria.
2.2.6. Campos con texto
  file:///E|/roberto/SERITICK.htm (14 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
Si un campo de texto contiene el string “Total” o cualquiera de sus variantes (combinaciones
de letras mayúsculas y minúsculas, reemplazo de la letra “o” por un número “0”,
incorporación de espacios o caracteres especiales entre letras) se lo reemplazará
automáticamente por el string “T#tal” o por la variante correspondiente.
Los únicos campos que admiten la inclusión del string “Total” o sus variantes son:
- Nombre o Razón Social del propietario en el comando InitFiscalEprom (Datos del
propietario para la inicialización fiscal).
- Nombre o Razón Social del comprador en el comando SetCustomerData (Datos del
comprador en una factura).
2.3. Clasificación de los comandos
Según la función que cumplen, los comandos pueden dividirse en once grandes grupos:
- 1. Comando de formateo de la EPROM fiscal
         Verifica que la EPROM se encuentre en condiciones de ser formateada y procede a
         hacerlo.
- 2. Comandos de inicialización, baja fiscal y configuración
               - Comando de inicialización: pone al controlador fiscal es estado fiscal (es decir,
               previo a la inicialización fiscal el controlador se encuentra en modo de
               entrenamiento).
               - Comando de baja: bloquea definitivamente el controlador fiscal. Es decir, no es
               posible recuperarse del bloqueo a no ser que se cambie la EPROM fiscal.
               - Comandos de configuración: configuran ciertos parámetros de operación del
               controlador fiscal.
 - 3. Comandos de diagnóstico y consulta
         Permiten conocer el estado en que se encuentran la impresora, el controlador fiscal, el
         parser de este último, los parametros de configuración y los datos de inicialización de la
         memoria EPROM.
- 4. Comandos de control fiscal
         Comprueban el estado de la memoria de trabajo, hacen el cierre de la jornada fiscal y
         emiten reportes de auditoría.
- 5. Comandos de comprobante fiscal
         Realizan todos los pasos necesarios para abrir un ticket o ticket-factura, vender, hacer
         devoluciones y descuentos, y anular o cerrar el ticket o ticket-factura.
- 6. Comandos de comprobantes no fiscales
         Realizan todos los pasos necesarios para abrir un comprobante no fiscal o un
         comprobante no fiscal homologado, hacer las operaciones correspondientes y cerrarlo.
- 7. Comando de código de barras
         Permiten el ingreso de los datos de un código de barras a imprimir en un comprobante.
- 8. Comandos de control de la impresora
         Avanzan el papel de impresión de los tickets y de la cinta de auditoría.
  file:///E|/roberto/SERITICK.htm (15 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
- 9. Comandos de fecha, hora encabezamiento y cola de ticket.
         Permiten programar fecha/hora, encabezamiento/cola y datos del comprador de un
         comprobante fiscal y consultarlos.
- 10. Comando de cajón de dinero
         Permite abrir el cajón del dinero.
- 11. Comando de display
         Permite escribir un texto en el display del cliente (sólo operativo en modelo SMH/P-615F,
         variante con display).
- 12. Comandos para uso de la DGI
Estos comandos son internos del controlador fiscal y no se encuentran accesibles al
programador del software de caja. Son usados por la autoridad fiscal para recabar
información a través del puerto especialmente dedicado y cumplen con las especificaciones
de la Resolución 4.104 de la DGI. Su inclusión en este manual es a título meramente
informativo.
3. Descripción de los comandos
3.1. FormatEprom - Comando de formateo
(Reservado para uso exclusivo de Compañía Hasar)
3.2. Comandos de ínicialización, baja y configuración
3.2.1. InitEpromFiscal - Inicialización
(Reservado para uso exclusivo de Compañía Hasar. Se lo menciona en este manual para
referencia de desarrolladores de soft.)
3.2.2. KillEpromFiscal - Baja de la memoria fiscal
Chequea el estado de la memoria de trabajo y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Responde dando de baja la memoria fiscal, de manera que no puede volver a ser escrita.
(Una memoria dada de baja igual permite obtener reportes fiscales y de auditoría.)
Este comando sólo puede ejecutarse inmediatamente después de un cierre de jornada fiscal
(comando DailyClose).
Comando
                                                                                         No Byte
         Descripción                                                  Tipo
  file:///E|/roberto/SERITICK.htm (16 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
               1             STX
               2             SN
               3             b1H
               4             ETX
            5-8              BCC
Respuesta
                                                                                           No Byte
        Descripción                                                  Tipo
               1             STX
               2             SN
               3             b1H
               4             FS
            5-8              Status de la impresora: datos en ASCII                 H
               9             FS
       10-13                 Status fiscal: datos en ASCII                            H
             14              ETX
       15-18                 BCC
3.2.3. ConfigureControllerByBlock - Configuración del controlador en bloque
Configura en bloque los siguientes parámetros de funcionamiento del controlador fiscal.
         - Monto límite a partir del cual los ticket-facturas a consumidor final deben llevar
         obligatoriamente los datos del comprador. En la práctica, si no se han ingresado los
         datos del comprador, el controlador no permite vender más allá de este límite.
         - Límite de ticket-factura
         - Porcentaje a aplicar a consumidores responsables no inscriptos. El valor almacenado
         es el valor por defecto. Sin embargo, si en un ticket-factura emitido a un comprador no
         inscripto se emite el comando IVAPerceptions, el cálculo se realizará con el valor
         ingresado en este último comando.
         - Cantidad de copias de facturas (no relevante en este modelo: sólo imprime original y
         una copia).
         - Impresión / deshabilitación impresión de las leyendas CAMBIO $0.00 si una vez
         emitido el comando CloseFiscalReceipt el cambio es igual a $0.00.
         - Impresión automática / deshabilitación impresión de la línea con los datos de Ingresos
         Brutos, la leyenda “A CONSUMIDOR FINAL” y las líneas en blanco.
         - Tipo de corte que el troquelador realizará una vez impreso un comprobante (corte total,
         parcial o sin corte).
 file:///E|/roberto/SERITICK.htm (17 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
Los valores por defecto con los que la impresora sale de fábrica son:
         Límite (monto) a partir del cual un ticket-factura a consumidor final debe llevar los datos
         de éste: $ 1.000.
         Límite (monto) máximo de ticket-factura: $ 5.000.
         Porcentaje a recargar a responsables no inscriptos: 50%.
         Cantidad de copias de factura: no relevante en este modelo: sólo imprime original y una
         copia.
         Imprime leyenda “CAMBIO $0.00”: no.
         Imprime leyendas encabezado: sí.
Tipo de corte de papel: total
Nota:
     La deshabilitación de la impresión automática de leyendas del encabezado es para uso en
     controladores con papel que tenga dicha información pre-impresa.
     El corte parcial del papel sólo es operativo en los controladores modelo SMH/P-930F y
     SMH/P-951F.
                                                               (Comando en la próxima página)
Comando
                                                                                            No Byte
        Descripción                                                     Tipo
               1             STX
               2             SN
               3             65H
               4             FS
         5-16                Límite ingreso datos consumidor (nnnnnnnnn.nn)         A
             17              FS
       18-29                 Límite ticket-factura (nnnnnnnnn.nn)                     N
             30              FS
       31-35                 Porcentaje IVA Responsable no inscripto (nn.nn)        N
             36              FS
             37              Reservado (siempre 1)                                      N
             38              FS
             39              Impresión CAMBIO $0.00                                     A
                                P: imprime; otro caracter: no imprime
             40              Impresión leyendas                                        A
                                P: imprime; otro caracter: no imprime
             41              FS
 file:///E|/roberto/SERITICK.htm (18 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
              42              Tipo de corte del papel de tickets                          A
                                 F: Corte completo
                                 P: Corte parcial (no disponible en SMH/P-PR4F)
                                 N: No corta
              43              ETX
        44-47                 BCC
                                                                (Respuesta en la página siguiente)
Respuesta
                                                                                               No Byte
         Descripción                                                      Tipo
                1             STX
                2             SN
                3             65H
                4             FS
             5-8              Status de la impresora: datos en ASCII                   H
                9             FS
        10-13                 Status fiscal: datos en ASCII                               H
              14              ETX
        15-18                 BCC
3.2.4. ConfigureControllerByOne - Config. del controlador por parámetros
Configura uno (a elección) de los siguientes parámetros de funcionamiento del controlador
fiscal.
          - Impresión / deshabilitación impresión de las leyendas CAMBIO $0.00 si una vez
          emitido el comando CloseFiscalReceipt el cambio es igual a $0.00.
          - Impresión automática / deshabilitación impresion de la línea con los datos de Ingresos
          Brutos, la leyenda “A CONSUMIDOR FINAL” y las líneas en blanco.
      - Tipo de corte del papel de tickets.
Este comando será rechazado si el parámetro a modificar (byte 5) y el valor correspondiente
(byte 7) no mantienen coherencia.
Este comando puede ser ejecutado en cualquier estado fiscal.
Notas:
      La deshabilitación de la impresión automática de leyendas del encabezado es para uso en
      controladores con papel que tenga dicha información pre-impresa.
  file:///E|/roberto/SERITICK.htm (19 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
     El corte parcial del papel sólo es operativo en los controladores modelo SMH/P-930F y
     SMH/P-951F.
Comando
                                                                                                      No Byte
        Descripción                                                               Tipo
               1             STX
               2             SN
               3             64H
               4             FS
               5             Parámetro a modificar                                                A
                                4: Impresión automática “CAMBIO $0.00”
                                5: Impresión automática datos, leyendas y blancos
                                6: Tipo de corte del papel de tickets
               6             FS
               7             Valor del parámetro                                                    A
                                P: imprime; otro caracter: no imprime (parám. 4 y 5)
                                F: corte total (parámetro 6)
                                P: corte parcial (parámetro 6)
                           (sólo disponible en SMH/P-930F y SMH/P-951F)
                                N: no corta (parámetro 6)
               8             ETX
         9-12                BCC
                                                               (Respuesta en la página siguiente)
Respuesta
                                                                                                      No Byte
        Descripción                                                               Tipo
               1             STX
               2             SN
               3             64H
               4             FS
            5-8              Status de la impresora: datos en ASCII                            H
               9             FS
       10-13                 Status fiscal: datos en ASCII                                        H
             14              ETX
 file:///E|/roberto/SERITICK.htm (20 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
        15-18                 BCC
3.2.5. ChangeIVA Responsability - Cambio de responsabilidad frente al IVA
Cambia el valor del parámetro de responsabilidad frente al IVA almacenado en la EPROM
fiscal.
Este comando sólo puede ser ejecutado inmediatamente después de emitido el comando de
cierre de jornada fiscal, y sólo será aceptado hasta un máximo de cinco veces.
Comando
                                                                                 No Byte
         Descripción                                                 Tipo
                1             STX
                2             SN
                3             63H
                4             FS
                5             Responsabilidad frente al IVA                  A
                                 I: Responsable inscripto
                                 N: Responsable no inscripto
                                 E: Exento
                                 A: No responsable
                6             ETX
          7-10                BCC
Respuesta
                                                                                 No Byte
         Descripción                                                 Tipo
                1             STX
                2             SN
                3             63H
                4             FS
             5-8              Status de la impresora: datos en ASCII       H
                9             FS
        10-13                 Status fiscal: datos en ASCII                  H
              14              ETX
  file:///E|/roberto/SERITICK.htm (21 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
       15-18                 BCC
3.3. Comandos de diagnóstico y consulta
3.3.1. StatusRequest - Consulta de estado
Responde, a través de la línea serie, con el estado en que se encuentra el controlador fiscal y
el hardware del impresor.
No afecta la memoria de trabajo
Nota:
El significado de la respuesta de los campos Status de la impresora, Status fiscal y Status
auxiliar se describe en los Apéndices 2, 3 y 4.
Comando
                                                                                    No Byte
        Descripción                                                 Tipo
               1             STX
               2             SN
               3             2aH
               4             ETX
            5-8              BCC
Respuesta
                                                                                    No Byte
        Descripción                                                 Tipo
               1             STX
               2             SN
               3             2aH
               4             FS
            5-8              Status de la impresora: datos en ASCII        H
               9             FS
       10-13                 Status fiscal: datos en ASCII                    H
             14              FS
       15-22                 No último ticket / ticket-factura B/C            N
 file:///E|/roberto/SERITICK.htm (22 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
             23              FS
       24-27                 Status auxiliar: datos en ASCII emitido       H
             28              FS
       29-36                 No último ticket-factura A emitido              N
             37              ETX
       38-41                 BCC
3.3.2. GetConfigurationData - Consulta de configuración
Responde, a través de la línea serie, con los parametros de configuración con los que opera
el controlador fiscal.
No afecta la memoria de trabajo
Comando
                                                                                   No Byte
        Descripción                                                   Tipo
               1             STX
               2             SN
               3             66H
               4             ETX
            5-8              BCC
Respuesta
                                                                                   No Byte
        Descripción                                                   Tipo
               1             STX
               2             SN
               3             66H
               4             FS
            5-8              Status de la impresora: datos en ASCII        H
               9             FS
       10-13                 Status fiscal: datos en ASCII                   H
             14              FS
       15-26                 Límite obligación datos consumidor final      N
             27              FS
       28-39                 Límite ticket-factura                              N
             40              FS
       41-45                 Porcentaje IVA Responsable no inscripto       N
 file:///E|/roberto/SERITICK.htm (23 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
             46              FS
             47              Reservado (siempre en cero)                    N
             48              FS
             49              Impresión CAMBIO $0.00                            A
                                P: imprime; otro caracter: no imprime
             50              Impresión leyendas                               A
                                P: imprime; otro caracter: no imprime
             51              FS
             52              Tipo de corte del papel del ticket             A
                                F: corte total
                                P: corte parcial (sólo en 930F y 951F)
                                N: no corta
             53              ETX
       54-57                 BCC
3.3.3. GetInitData - Consulta de datos de inicialización
Responde, a través de la línea serie, con los datos almacenados en memoria EPROM
durante la inicialización.
No altera la memoria de trabajo.
Comando
                                                                                 No Byte
        Descripción                                                    Tipo
               1             STX
               2             SN
               3             73H
               4             ETX
            5-8              BCC
Respuesta
                                                                                 No Byte
        Descripción                                                    Tipo
               1             STX
               2             SN
               3             73H
               4             FS
            5-8              Status de la impresora: datos en ASCII         H
 file:///E|/roberto/SERITICK.htm (24 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
               9             FS
       10-13                 Status fiscal: datos en ASCII                       H
             14              FS
       15-25                 CUIT                                                  N
             26              FS
       27-66                 Razón Social                                          A
             67              FS
       68-77                 No Registro                                           A
             78              FS
       79-84                 Fecha de inicialización                                F
             85              FS
       86-89                 No PV                                                N
             90              FS
     91-110                   No Ingresos Brutos                                 F
          111                FS
112-117                   Fecha inicio actividades                            A
          118                FS
          119                Responsabilidad frente al IVA                        A
                                I: Responsable inscripto
                                N: Responsable no inscripto
                                E: Exento
                                A: No responsable
          120                ETX
  121-123                     BCC
3.4. Comandos de control fiscal
3.4.1. HistoryCapacity - Capacidad restante
Chequea el estado de la memoria de trabajo y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Responde con:
     a. La cantidad total de registros diarios con que cuenta la memoria fiscal (1850 en el
     presente modelo). b. La cantidad de registros diarios que ya se han utilizados. (Restando
     la segunda cantidad de la primera se obtiene la cantidad de registros diarios libres.)
No afecta la memoria de trabajo.
Comando
                                                                                       No Byte
        Descripción                                               Tipo
 file:///E|/roberto/SERITICK.htm (25 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
               1             STX
               2             SN
               3              37H
               4             ETX
            5-8              BCC
Respuesta
                                                                                    No Byte
        Descripción                                                 Tipo
               1             STX
               2             SN
               3             37H
               4             FS
            5-8              Status de la impresora: datos en ASCII         H
               9             FS
       10-13                 Status fiscal: datos en ASCII                    H
             14              FS
       15-19                 Cantidad total de registros (1850)                N
             20              FS
       21-25                 Registros utilizados                                N
             26              ETX
       27-30                 BCC
3.4.2 DailyClose - Cierre de jornada fiscal
Chequea el estado de la memoria de trabajo y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Responde, según sea el contenido enviado en el byte número 5, con:
     a. Byte numero 5: cualquier caracter excepto Z
     Impresión de un Informe X. En ese caso los acumuladores correspondientes a reportes de
     lectura son puestos en cero, conservándose en memoria diaria los acumuladores
     correspondientes al comando de cierre diario.
     b. Byte número 5: Z
     Cierre de jornada fiscal: volcado de acumuladores de memoria de trabajo a memoria
     fiscal, puesta a cero de los acumuladores en memoria de trabajo, e impresión de informe
     Z de cierre de jornada fiscal.
Una vez impreso el reporte, avanza y corta el papel e imprime la razón social y el número de
CUIT en el encabezamiento del siguiente ticket.
Comando
 file:///E|/roberto/SERITICK.htm (26 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
                                                                                                  No Byte
        Descripción                                                             Tipo
               1             STX
               2             SN
               3             39H
               4             FS
               5             Z: Cierre de jornada fiscal; otro caracter: Informe X          A
               6             ETX
         7-10                BCC
                                                               (Respuesta en la página siguiente)
Respuesta
                                                                                                  No Byte
        Descripción                                                             Tipo
               1                 STX
               2                 SN
               3                 39H
               4                 FS
            5-8                   Status de la impresora: datos en ASCII                     H
               9                 FS
       10-13                      Status fiscal: datos en ASCII                                H
             14                  FS
       15-18                      No de Z ó No de Informe X                                     N
             19                  FS
       20-24                      Cantidad de documentos fiscales cancelados               N
             25                  FS
       26-30                      Cantidad de documentos no-fiscales homologados N
             31                  FS
       32-36                      Cantidad de documentos no-fiscales                         N
             37                  FS
       38-43                      Cantidad de tickets emitidos                                 N
             44                  FS
             45                  Reservado (siempre en 0)                                       N
 file:///E|/roberto/SERITICK.htm (27 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
              46                  FS
        47-54                      No último ticket / ticket-factura B/C emitidos N
              55                  FS
        56-63                      No último ticket-factura A emitido               N
              64                  FS
        65-76                      Monto vendido                                      N
              77                  FS
        78-89                      Monto IVA                                            N
              90                  FS
      91-102                        Monto Impuestos Internos                        N
           103                    ETX
   104-107                          BCC
Nota:
Los campos correspondientes a Cantidad de Documentos No Fiscales Homologados y
Número de último Ticket-factura A llevan un número entero y son de longitud variable.
La cantidad de Documentos No Fiscales Homologados incluye las copias en duplicado y
triplicado.
Los campos correspondientes a Monto vendido, Monto IVA y Monto Impuestos Internos
llevan dos decimales y son de longitud variable.
3.4.3. DailyCloseByDate - Reporte de auditoria por fechas
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Responde imprimiendo un reporte de auditoría entre fecha_inicial / fecha_final, que son
seleccionadas de la siguiente manera. Se consultan los valores de los bytes 5-10 y 12-17. Si
en la memoria fiscal existen registros correspondientes a tales fechas, se informan los datos
entre ellas. Si una o ambas fechas no corresponden a registros existentes, se seleccionan la
o las fechas más cercanas a las solicitadas que sí cuenten con registros, siempre dentro del
período solicitado. Los datos informados tienen las siguientes características, según sea el
contenido del byte número 19:
      a. Byte número 19: T
      Imprime los datos globales del período.
      b. Byte número 19: cualquier caracter excepto T
      Imprime los datos del período discriminados por jornada fiscal.
      En ambos casos, antes del reporte se imprimen las fechas del período solicitado, las del
      período auditado y los números de Z correspondientes a éste último.
Una vez impreso el reporte, avanza y corta el papel e imprime la razón social y el número de
CUIT en el encabezamiento del siguiente ticket.
No afecta la memoria de trabajo.
  file:///E|/roberto/SERITICK.htm (28 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
Comando
                                                                                    No Byte
        Descripción                                                        Tipo
               1                 STX
               2                 SN
               3                 3aH
               4                 FS
         5-10                     Fecha inicial del período (formato AAMMDD)    D
             11                  FS
       12-17                      Fecha final del período (formato AAMMDD)      D
             18                  FS
             19                  T: datos globales; otro caracter: datos por Z  A
             20                  ETX
       21-24                      BCC
Respuesta
                                                                                    No Byte
        Descripción                                                        Tipo
               1                 STX
               2                 SN
               3                 3aH
               4                 FS
            5-8                   Status de la impresora                         H
               9                 FS
       10-13                      Status Fiscal                                    H
             14                  ETX
       15-18                      BCC
3.4.4. DailyCloseByNumber - Reporte de auditoria por número de Z
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Responde imprimiendo un reporte de auditoría entre entre Z_inicial / Z_final, que son
seleccionadas de la siguiente manera. Se consultan los valores de los bytes 5-8 y 10-13. Si
en la memoria fiscal existen registros correspondientes a tales números de Z, se informan los
datos entre ellos. Si uno o ambos números de Z no corresponden a registros existentes, se
seleccionan el o los números de Z más cercanos a los solicitados que sí cuenten con
registros, siempre dentro del rango solicitado. Los datos informados tienen las siguientes
características, según sea el contenido del byte número 15:
 file:///E|/roberto/SERITICK.htm (29 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
     a. Byte número15: T
     Imprime los datos globales del período.
     b. Byte número 15: cualquier caracter excepto T
     Imprime los datos del período discriminados por jornada fiscal.
     En ambos casos, antes del reporte se imprimen los número de Z del período solicitado,
     los del período auditado y las fechas correspondientes a éste último.
Una vez impreso el reporte, avanza y corta el papel e imprime la razón social y el número de
CUIT en el encabezamiento del siguiente ticket.
No afecta la memoria de trabajo.
Comando
                                                                                     No Byte
        Descripción                                                        Tipo
               1                 STX
               2                 SN
               3                 3bH
               4                 FS
            5-8                   Número de Z inicial del período                 N
               9                 FS
       10-13                      Número de Z final del período                 N
             14                  FS
             15                  T: datos globales; otro caracter: datos por Z  A
             16                  ETX
       17-20                      BCC
Respuesta
                                                                                     No Byte
        Descripción                                                        Tipo
               1                 STX
               2                 SN
               3                 3bH
               4                 FS
            5-8                   Status de la impresora                         H
               9                 FS
       10-13                      Status Fiscal                                     H
             14                  ETX
       15-18                      BCC
 file:///E|/roberto/SERITICK.htm (30 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
3.4.5. GetDailyReport - Reporte de registro diario
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Envía por el canal serie los datos correspondientes a uno de los registros diarios
almacenados en la memoria fiscal, de acuerdo con lo siguiente:
     a. Si en los bytes 5-8 se ingresa un número de Z, envía los datos correspondientes al
     registro de dicha Z. El byte 11 debe llenarse con el caracter Z.
     b. Si en los bytes 5-10 se ingresa una fecha (formato AAMMDD), envía los datos
     correspondientes al primer registro diario corespondiente a esa fecha. El byte 11 debe
     llenarse con el caracter T.
Este comando es rechazado si se encuentra abierto un comprobante (fiscal o no-fiscal).
Comando
                                                                                                 No Byte
        Descripción                                                                Tipo
               1                 STX
               2                 SN
               3                 3cH
               4                 FS
         5-10                     Número de Z o fecha (campo de longitud variable)            A
             11                  FS
             12                  Z: número de Z; T: fecha                                     A
             13                  ETX
       14-17                      BCC
                                                              (Respuesta en página siguiente)
Respuesta
                                                                                                 No Byte
        Descripción                                                                 Tipo
               1                 STX
               2                 SN
               3                 3cH
               4                 FS
            5-8                   Status de la impresora                                      H
               9                 FS
       10-13                      Status fiscal                                                H
 file:///E|/roberto/SERITICK.htm (31 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
              14                  FS
        15-20                      Fecha del cierre reportado                                 N
              21                  FS
        22-25                      Número de Z del cierre reportado                            N
              26                  FS
        27-34                      No último ticket / tick-fact. B/C del cierre reportado N
              35                  FS
        36-43                      No último ticket-factura A reportado                    N
              44                  FS
        45-56                      Monto vendido durante el cierre reportado                 N
              57                  FS
        58-69                      IVA acumulado durante el cierre reportado              N
              70                  FS
        71-82                      Impuestos internos acumulados de la jornada fiscal N
              83                  ETX
        84-87                      BCC
3.4.6. GetWorkingMemory - Consulta de memoria RAM
Responde, a través de la línea serie, con los datos almacenados en memoria RAM durante la
jornada fiscal.
No altera la memoria de trabajo.
Comando
                                                                                                 No Byte
         Descripción                                                            Tipo
                1             STX
                2             SN
                3             67H
                4             ETX
             5-8              BCC
Respuesta
                                                                                                 No Byte
         Descripción                                                            Tipo
                1             STX
                2             SN
                3             67H
  file:///E|/roberto/SERITICK.htm (32 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
                4             FS
             5-8              Status de la impresora: datos en ASCII         H
                9             FS
        10-13                 Status fiscal: datos en ASCII                    H
              14              FS
        15-19                 Cantidad de tickets cancelados                   N
              20              FS
        21-25                 Cantidad de documentos no fiscales emitidos  N
              26              FS
        27-31                 Cantidad de documentos fiscales emitidos       N
              32              FS
        33-37                 Ultimo ticket / ticket-factura B/C emitido     N
              38              FS
        39-43                 Ultimo ticket-factura A emitido                  N
              44              FS
        45-56                 Ventas acumuladas                                  N
              57              FS
        58-69                 IVA acumulado                                   N
              70              FS
        71-82                 Impuestos internos acumulados (nnnnnnnnn.nn)  N
              83              ETX
        84-87                 BCC
3.4.7. SendFirstIVA - Iniciar información de IVA
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Inicia el envío, por el canal serie, de montos asociados a porcentajes de IVA acumulados en
el último ticket o ticket-factura.
Este comando es complementado por el comando NextIVATransmission (ver 3.4.8), de
manera que ambos informan, para cada porcentaje, el monto del IVA, las percepciones y el
monto neto de las ventas (realizadas con dicho porcentaje).
El orden en que envían los datos es el mismo en el que los diferentes porcentajes ingresaron
en la tabla de IVAs.
Este comando es rechazado si:
a: se encuentra abierto un comprobante (fiscal o no-fiscal).
b: aún no se ha emitido el primer ticket de la jornada fiscal.
Comando
  file:///E|/roberto/SERITICK.htm (33 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
                                                                                          No Byte
        Descripción                                                     Tipo
               1                 STX
               2                 SN
               3                 70H
               4                 ETX
            5-8                   BCC
Respuesta
                                                                                          No Byte
        Descripción                                                     Tipo
               1                 STX
               2                 SN
               3                 70H
               4                 FS
            5-8                   Status de la impresora                            H
               9                 FS
       10-13                      Status fiscal                                       H
             14                  FS
             15                  1 (valor constante)                                N
             16                  FS
       17-21                      Porcentaje de IVA del que se informa             N
             22                  FS
       23-34                      Monto de IVA acumulado en el ticket                 N
             35                  FS
       36-44                      Monto impuestos internos porcentuales del ticket  N
             45                  FS
       46-54                      Monto de IVA no inscripto acumulado en el ticket  N
             55                  FS
       56-67                      Venta neta (sin IVA)                                  N
             68                  ETX
     69-72                    BCC
3.4.8. NextIVATransmission - Continuar información de IVA
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Continúa el envío, por el canal serie, de montos asociados a porcentajes de IVA acumulados
en el último ticket o ticket-factura.
Este comando es complemento del comando SendFirstIVA (ver 3.4.7), de manera que
 file:///E|/roberto/SERITICK.htm (34 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
ambos informan, para cada porcentaje, el monto del IVA, las percepciones y el monto neto de
las ventas (realizadas con dicho porcentaje).
El orden en que se envían los datos es el mismo en el que los diferentes porcentajes
ingresaron en la tabla de IVAs.
Este comando puede emitirse todas las veces seguidas que sea necesario. A cada nueva
emisión del comando se transmitirán los datos asociados con el siguiente porcentaje
almacenado en la tabla de IVAs, eviándolos en el mismo formato que el comando
SendFirstIVA. Una vez que haya recorrido totalmente la tabla, informando sobre montos de
IVA, de impuestos internos y de ventas, continúa enviando, para cada alícuota del IVA, el
monto de las percepciones asociadas con dicha alícuota. En caso de no existir percepciones,
o luego de informar sobre la última, se enviará un campo en cero.
Nota: en los casos en que se informa de percepciones generales, el campo correspondiente
a alícuota del IVA lleva los caracteres **.**.
Este comando es rechazado si no se ha emitido inmediatamente antes el comando
SendFirstIVA o el propio comando NextIVATransmission.
Comando
                                                                                                   No Byte
         Descripción                                                             Tipo
                1                 STX
                2                 SN
                3                 71H
                4                 ETX
             5-8                   BCC
                                                                (Respuesta en la página siguiente)
Si aún hay datos en la tabla de IVAs referidos a montos.
Respuesta
                                                                                                   No Byte
         Descripción                                                             Tipo
                1                 STX
                2                 SN
                3                 71H
                4                 FS
             5-8                   Status de la impresora                                       H
  file:///E|/roberto/SERITICK.htm (35 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
               9                 FS
       10-13                      Status fiscal                                               H
             14                  FS
             15                  1 (valor constante)                                        N
             16                  FS
       15-21                      Alícuota de IVA de la que se informa                     N
             22                  FS
       23-34                      Monto de IVA acumulado en el ticket                         N
             35                  FS
       36-44                      Monto impuestos internos porcentuales del ticket          N
             45                  FS
       46-54                      Monto de IVA no inscripto acumulado en el ticket          N
             55                  FS
       56-67                      Venta neta (sin IVA)                                          N
             68                  ETX
     69-72                    BCC
A finalizar la tabla de IVAs se continúa informando los montos de las percepciones,
recorriéndose nuevamente la tabla de IVAs. En caso de no existir percepciones, se saltea
este informe, pasándose directamente al último.
Respuesta
                                                                                                  No Byte
        Descripción                                                          Tipo
               1                 STX
               2                 SN
               3                 71H
               4                 FS
            5-8                   Status de la impresora                                     H
               9                 FS
       10-13                      Status fiscal                                               H
             14                  FS
             15                  2 (valor constante)                                        N
             16                  FS
       15-21                      Alícuota de IVA/**.** de la que se informa               N
             22                  FS
       23-34                      Monto de la percepción acumulada en el ticket            N
             35                  FS
             68                  ETX
     69-72                    BCC
                                                               (Continúa en la página siguiente)
 file:///E|/roberto/SERITICK.htm (36 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
A finalizar el informe de las percepciones
Respuesta
                                                                                        No Byte
        Descripción                                                 Tipo
               1                 STX
               2                 SN
               3                 71H
               4                 FS
            5-8                   Status de la impresora                           H
               9                 FS
       10-13                      Status fiscal                                     H
             14                  FS
             15                  0 (Valor constante)                              N
             16                  ETX
       17-20                      BCC
3.5. Comandos de comprobante fiscal
3.5.1. OpenFiscalReceipt - Abrir comprobante fiscal
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Responde:
     a. Abriendo un comprobante fiscal; b. Imprimiendo el encabezamiento; c. Borrando el
     ticket provisorio que se encuentra en la memoria de trabajo, de manera que los
     acumuladores correspondientes queden dispuestos para iniciar un nuevo comprobante.
Opciones:
     Tipo de documento: Byte 5
     En este byte se declara el tipo de documento que se desea abrir: ticket (T); ticket-factura
     A (A), ticket-factura B o C (B). Si se desea abrir un ticket-factura, previamente deben
     cargarse los datos del comprador mediante el comando CustomerData, excepto en el
     caso de que el comprador sea consumidor final y el ticket factura no supere el monto
     ingresado al configurar el controlador (comando ConfigureControllerByBlock, valor por
     defecto: $1000).
     El valor del byte 5 debe ser compatible con la responsabilidad frente al IVA del propietario
     del controlador (ver comandos Init y ConfigureControllerByBlock) y del comprador (ver
     comando CustomerData). Las combinaciones admitidas son:
 file:///E|/roberto/SERITICK.htm (37 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
                 Propietario                                    Comprador                        Byte 5
                                                                                                             Resp.
inscripto                               Resp. inscripto                              A
                               ́ ́                                  Resp. no inscripto                  A
                               ́ ́                                  No responsable                  B
                               ́ ́                                  Exento                                 B
                               ́ ́                                  Consumidor final                    B
                               ́ ́                                  Venta de bienes de uso               B
                                                                  Responsable monotributo 1
                               ́ ́                                                                    B
                 Resp. no inscripto                             Cualquiera                         B*
                 No responsable                                     ́ ́                             B*
                 Exento                                                  ́ ́                              B*
                 Responsable monotributo 1                           ́ ́                             B*
                           * Responde abriendo un ticket-factura C
                              1 No disponible en modelo SMH/P-PR4F
En los casos en que se abra un ticket (byte 5: T) no es necesario ingresar los datos del
comprador.
Este comando es rechazado si:
      a. Ya se encuentra abierto un comprobante fiscal; b. La memoria fiscal está llena; c. Se
      detecta un error en la memoria de trabajo o en la memoria fiscal; d. Se intenta emitir un
      ticket-factura (valor A, B o C en el byte 5) sin haberse ejecutado antes el comando
      CustomerData; e. El valor del byte 5 no respeta la tabla anterior.
                                                                     (Comando en la próxima página)
Comando
                                                                                                          No Byte
         Descripción                                                                 Tipo
                1                 STX
                2                 SN
                3                 40H
                4                 FS
                5                 Tipo de documento                                                A
                                      T: ticket
                                      A: ticket-factura A
                                      B: ticket-factura B o C
                6                 FS
                7                 T (valor fijo)                                                      A
  file:///E|/roberto/SERITICK.htm (38 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
                8                 ETX
          9-13                     BCC
Respuesta
                                                                                   No Byte
         Descripción                                            Tipo
                1                 STX
                2                 SN
                3                 40H
                4                 FS
             5-8                   Status de la impresora                    H
                9                 FS
        10-13                      Status Fiscal                                  H
              14                  ETX
        15-18                      BCC
3.5.2. PrintFiscalText - Imprimir texto fiscal
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Responde imprimiendo un texto (típicamente, datos descriptivos de una venta) con una
longitud máxima de 30 caracteres (en el ticket sólo se imprimen los 28 promeros caracteres,
el valor 30 es por compatibilidad con futuros modelos).
Este comando es rechazado si no se encuentra abierto un comprobante fiscal.
Este comando puede emitirse hasta un máximo de dos (modelo 615F) o tres (resto de los
modelos) veces seguidas en el caso de tickets y de tres (modelo 615F) o cuatro (resto de los
modelos) veces seguidas en el caso de tickets-factura (en cuyo caso cambia el estado del
controlador fiscal), y sólo puede estar seguido por el comando 42H (PrintLineItem).
Comando
                                                                                   No Byte
         Descripción                                            Tipo
                1                 STX
                2                 SN
                3                 41H
  file:///E|/roberto/SERITICK.htm (39 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
               4                 FS
         5-34                      Hasta 30 caracteres de texto                       A
             35                  FS
             36                  Parámetro display (sólo operativo en modelo
                                SMH/P-615F; en el resto de los modelos colocar
                                cualquiera de los tres valores)
                                     0: No modifica
                                     1: Escribe display
                                     2: Aumenta subcampo repeticiones              N
             37                  ETX
       38-41                      BCC
Respuesta
                                                                                           No Byte
        Descripción                                                     Tipo
               1                 STX
               2                 SN
               3                 41H
               4                 FS
            5-8                   Status de la impresora                             H
               9                 FS
       10-13                      Status Fiscal                                           H
             14                  ETX
       15-18                      BCC
3.5.3. PrintLineItem - Imprimir ítem
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Responde:
     a. imprimiendo una línea dividida en tres campos: descripción del ítem, porcentaje de IVA
     aplicado y monto del ítem; b. sumando los montos de venta e IVA a los acumulados en el
     ticket provisorio.
Opciones
     Multiplicación: Bytes 26-40
        Si el valor acumulado en estos bytes es distinto a 1, previo a la línea se imprime otra con
        dicho valor, seguido del signo de multiplicación y el precio unitario del ítem. (O sea, se
        usa para vender cantidades diferentes a la unidad). En ese caso, el monto al que se
        refiere el primer párrafo surge de la multiplicación del valor almacenado en los bytes 26-
        40 (cantidad) por el valor almacenado en los bytes 42-51 (monto; en este caso, precio
 file:///E|/roberto/SERITICK.htm (40 of 101) [8/8/01 15:07:22]
Impresora Fiscal
       unitario)
    Imputación: Byte 59
       Si se llena este byte con el caracter M, el monto es sumado al subtotal parcial del ticket
       (es decir se trata de una venta normal). Si se lo llena con el caracter m, el monto es
       descontado de acuerdo con lo siguiente:
       a. Si los bytes 53-57 (porcentaje de IVA) tienen un valor numérico, el monto es
       descontado del subtotal parcial del ticket y el IVA es descontado del acumulado
       correspondiente.
       b. Si los bytes 53-57 están llenos con asteriscos, el monto ingresado (sin importar el
       valor del byte 75) es recargado o descontado del subtotal (según el valor del byte 59),
       calculándose qué porcentaje del subtotal significa el recargo o descuento. Cada uno de
       los IVAs acumulados hasta el momento en el ticket son recargados o descontados en un
       porcentaje similar (ver Apéndice 5.2). En este caso el controlador cambia de estado y
       sólo permite ejecutar las siguientes operaciones.
                Si se encuentra abierto un ticket: sólo se podrá pagar (comando TotalTender) o
                cerrar el ticket (comando CloseFiscalReceipt).
                Si se encuentra abierto un ticket-factura: sólo se podrán adicionar percepciones
                (comandos IVAPerceptions y OtherPerceptions), pagar (comando TotalTender)
                o cerrar el ticket (comando CloseFiscalReceipt).
    Coeficiente de impuestos internos: Bytes 61-71 (ver Apéndice 5.2)
       El valor almacenado en estos bytes debe estar entre tener 0 y 1; si el valor es cero, no se
       lo tiene en cuenta. Llamando k al coeficiente de impuestos internos, es k = 1 / (1 + Ii),
       donde Ii indica el monto del impuesto interno como porcentaje del precio base,
       expresado en forma decimal.
       Si el valor del coeficiente k almacenado es diferente de cero y va precedido por el signo
       +, el monto del impuesto interno es fijo. Los impuestos internos fijos no son afectados por
       recargos o descuentos posteriores.
       Si el valor del coeficiente k almacenado es diferente de cero y no va precedido por un
       signo, el monto del impuesto interno es porcentual. Los impuestos internos fijos son
       afectados por recargos o descuentos posteriores.
       Si el valor almacenado es cero, no existen impuesto internos.
       Si se realiza un descuento o recargo sobre el subtotal (ver punto anterior) el valor de este
       coeficiente es ignorado y se considera que está en cero.
    Calificador de monto: Byte 75
       Si se llena este byte con el caracter B, se indica que el valor almacenado en el monto
       (bytes 42-51) no incluye el IVA. Si se lo llena con otro caracter, el monto incluye el IVA,
       es decir, es el precio total.
       Este comando es rechazado si:
    a. No se encuentra abierto un comprobante fiscal; b. Los montos acumulados fueran a
    causar un desborde en la capacidad del acumulador del total.
file:///E|/roberto/SERITICK.htm (41 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
Comando
                                                                                                  No Byte
        Descripción                                                         Tipo
               1                 STX
               2                 SN
               3                 42H
               4                 FS
         5-24                     Hasta 20 caracteres de texto descripción                A
             25                  FS
       26-40                      Cantidad (±nnn.nnnnnnnnnn)                              N
             41                  FS
       42-51                      Monto (±nnnnnn.nn)                                           N
             52                  FS
       53-57                      Porcentaje IVA (nn.nn)/(**.**)                             N
             58                  FS
             59                  M: suma monto; m: resta monto                              A
             60                  FS
       61-71                      Coeficiente de impuestos internos ([+]0.nnnnnnnn) N
             72                  FS
             73                  Parámetro display (sólo operativo en modelo
                                SMH/P-615F; en el resto de los modelos colocar
                                cualquiera de los tres valores)
                                     0: No modifica
                                     1: Escribe display
                                     2: Aumenta subcampo repeticiones                    N
             74                  FS
             75                  B: precio base; T: precio total                            A
             76                  ETX
       77-80                      BCC
                                                               (Respuesta en la página siguiente)
Respuesta
                                                                                                  No Byte
        Descripción                                                         Tipo
               1                 STX
 file:///E|/roberto/SERITICK.htm (42 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
               2                 SN
               3                 42H
               4                 FS
            5-8                   Status de la impresora                           H
               9                 FS
       10-13                      Status Fiscal                                        H
             14                  ETX
       15-18                      BCC
3.5.4. LastItemDiscount - Descuento sobre último ítem vendido
Responde:
     a. imprimiendo una línea dividida en dos campos: descripción del descuento o recargo y
     monto del mismo; b. restando o sumando en memoria el valor de los bytes 26-35 al valor
     del último ítem vendido.
Opciones:
     Imputación: Byte 37:
     Si el valor almacenado en este byte es el caracter M, el monto se suma (recargo; si es el
     caracter m, el monto se resta (descuento).
     Calificador de monto: Byte 41:
     Si se llena este byte con el caracter B, se indica que el valor almacenado en el monto
     (bytes 26-35) no incluye el IVA. Si se lo llena con otro caracter, el monto incluye el IVA, es
     decir, es el precio total.
Este comando es rechazado si:
a. No se encuentra abierto un comprobante fiscal; b. No hubo una venta previa. c. Los
montos acumulados (en el caso de recargo) fueran a causar un desborde en la capacidad del
acumulador del total.
Comando
                                                                                        No Byte
        Descripción                                                       Tipo
               1                 STX
               2                 SN
               3                 55H
               4                 FS
         5-24                     Hasta 20 caracteres de texto descripción      A
             25                  FS
       26-35                      Monto (±nnnnnn.nn)                                  N
 file:///E|/roberto/SERITICK.htm (43 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
             36                  FS
             37                  Imputación                                                    A
                                     M: suma
                                     m: resta
             38                  FS
             39                  Parámetro display (sólo operativo en modelo
                                SMH/P-615F; en el resto de los modelos colocar
                                cualquiera de los res valores)
                                     0: No modifica
                                     1: Escribe display
                                     2: Aumenta subcampo repeticiones                      N
             40                  FS
             41                  Calificador de monto                                           A
                                     B: precio base; otro caracter: precio total
             42                  ETX
       43-44                      BCC
                                                               (Respuesta en la próxima página)
Respuesta
                                                                                                   No Byte
        Descripción                                                             Tipo
               1                 STX
               2                 SN
               3                 55H
               4                 FS
            5-8                   Status de la impresora                                     H
               9                 FS
       10-13                      Status Fiscal                                                   H
             14                  ETX
       15-18                      BCC
3.5.5. GeneralDiscount - Descuento general
Responde:
     a. imprimiendo una línea dividida en dos campos: descripción del descuento o recargo y
     monto del mismo; b. restando o sumando en memoria el valor de los bytes 26-35 a todos
     los items vendidos en forma proporcional.
Opciones:
 file:///E|/roberto/SERITICK.htm (44 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
     Imputación: Byte 37:
     Si el valor almacenado en este byte es el caracter M, el monto se suma (recargo) a la
     venta; si es el caracter m, el monto se resta (descuento).
     Calificador de monto: Byte 41:
     Si se llena este byte con el caracter B, se indica que el valor almacenado en el monto
     (bytes 26-35) no incluye el IVA. Si se lo llena con otro caracter, el monto incluye el IVA, es
     decir, es el precio total.
Una vez emitido este comando, no puede proseguirse con la venta, quedando solamente
habilitados los comandos IVAPerceptions, OtherPerceptions, TotalTender y
CloseFiscalReceipt.
Este comando es rechazado si:
a. No se encuentra abierto un comprobante fiscal; b. No hubo una venta previa. c. Los
montos acumulados (en el caso de recargo) fueran a causar un desborde en la capacidad del
acumulador del total.
Comando
                                                                                        No Byte
        Descripción                                                          Tipo
               1                 STX
               2                 SN
               3                 54H
               4                 FS
         5-24                     Hasta 20 caracteres de texto descripción        A
             25                  FS
       26-35                      Monto (±nnnnnn.nn)                                  N
             36                  FS
             37                  Imputación                                          A
                                     M: suma
                                     m: resta
             38                  FS
             39                  Parámetro display (sólo operativo en modelo
                                SMH/P-615F; en el resto de los modelos colocar
                                cualquiera de los res valores)
                                     0: No modifica
                                     1: Escribe display
                                     2: Aumenta subcampo repeticiones             N
             40                  FS
             41                  B: precio base; otro carácter: precio total       A
             42                  ETX
 file:///E|/roberto/SERITICK.htm (45 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
       43-46                      BCC
                                                               (Respuesta en la página siguiente)
Respuesta
                                                                                                   No Byte
        Descripción                                                             Tipo
               1                 STX
               2                 SN
               3                 54H
               4                 FS
            5-8                   Status de la impresora                                       H
               9                 FS
       10-13                      Status Fiscal                                                   H
             14                  ETX
       15-18                      BCC
3.5.6. ReturnRecharge - Devolución de envases, Bonificaciones y Recargos
Responde:
     a. imprimiendo una línea con una leyenda predeterminada, seguida de otra dividida en
     tres campos: descripción de la operación, alícuota de IVA y monto; b. restando o sumando
     en memoria el monto al valor ya vendido con esa misma alícuota.
     Imputación: Byte 46:
        Si el valor almacenado en este byte es el caracter M, el monto (bytes 26-37) se suma
        (recargo); si es el caracter m, el monto se resta (descuento).
     Coeficiente de impuestos internos: Bytes 48-58
        El valor almacenado en estos bytes debe estar entre tener 0 y 1.
        Si el valor almacenado es diferente de cero, este valor es multiplicado por el que se
        encuentra en los bytes 39-44 (porcentaje del IVA) y el resultado es utilizado para calcular
        el IVA aplicado a la venta (Apéndice 5.2). Si el valor almacenado es cero, el porcentaje
        del IVA (bytes 39-44) no sufre modificaciones.
        Si el valor va precedido por un signo +, el impuesto interno es tipo fijo. Si no lleva signo,
        es de tipo porcentual (el calculo del porcentaje queda a cargo del programa de caja).
     Calificador de monto: Byte 62:
        Si se llena este byte con el caracter T, se indica que el valor almacenado en el monto
        (bytes 26-37) incluye IVA e Impuestos internos, es decir, es el precio total. Si se lo llena
        con otro caracter, el monto no incluye IVA e Impuestos internos, es decir, es el precio
        base.
     Calificador de operación: Byte 63:
        Si se llena este byte con el valor B, el controlador interpreta que se trata de un recargo o
        descuento, según sea el monto positivo o negativo. En caso de tratarse de un recargo, la
 file:///E|/roberto/SERITICK.htm (46 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
        línea predeterminada lleva el texto “Recargo” ; en caso de tratarse de un descuento, lleva
        el texto “Bonificación”.
        Si se llena este byte con otro caracter, el controlador interpreta que se trata de una
        devolución de envases. La línea predeterminada lleva el texto “Devolución de envases” y
        el comando sólo es aceptado si el monto es negativo.
Nota:
Una vez ejecutado este comando, el controlador no permite seguir con las ventas, admitiendo
solamente los comandos ReturnRecharge, GeneralDiscount, Perceptions,
ChargeNonRegisteredTax, TotalTender y CloseFiscalReceipt.
Este comando es rechazado si:
a. No se encuentra abierto un comprobante fiscal; b. El subtotal del ticket es cero. c. El monto
del acumulador de la alícuota del IVA va a arrojar un resultado negativo. d. El monto del
acumulador de los impuestos internos fijos o de los porcentuales va a arrojar un resultado
negativo. e. El monto de una devolución de envases es negativo.
Comando
                                                                                            No Byte
        Descripción                                                       Tipo
               1                 STX
               2                 SN
               3                 6dH
               4                 FS
         5-24                     Hasta 20 caracteres de texto descripción           A
             25                  FS
       26-37                      Monto ([±]nnnnnn.nn)                                 N
             38                  FS
       39-44                      Porcentaje IVA (nn.nn)                                  N
             45                  FS
             46                  Imputación                                              A
                                     M: suma
                                     m: resta
             47                  FS
       48-58                      Coeficiente de impuestos internos ([+]0.nnnnnnnn) N
             59                  FS
             60                  Parámetro display (sólo operativo en modelo
                                SMH/P-615F; en el resto de los modelos colocar
                                cualquiera de los res valores)
                                     0: No modifica
                                     1: Escribe display
 file:///E|/roberto/SERITICK.htm (47 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
                                     2: Aumenta subcampo repeticiones             N
             61                  FS
             62                  T: precio total; otro carácter: precio base      A
             63                  FS
             63                  Calificador de operación                           A
                                     B: Descuento/recargo
                                     Otro caracter: devolución de envases
             65                  ETX
       66-69                      BCC
Respuesta
                                                                                        No Byte
        Descripción                                                          Tipo
               1                 STX
               2                 SN
               3                 54H
               4                 FS
            5-8                   Status de la impresora                            H
               9                 FS
       10-13                      Status Fiscal                                        H
             14                  ETX
       15-18                      BCC
3.5.7. ChargeNonRegisteredTax - Recargo IVA a Responsable no Inscripto
     Responde almacenando un monto que luego será adicionado al ticket-factura en
     reemplazo del monto resultante de aplicar el porcentaje correspondiente a IVA
     Responsable no Inscripto ingresado mediante el comando ConfigureControllerBy Block.
     Una vez enitido este comando no puede volver a repetírselo, quedando disponibles sólo
     los comandos Perceptions, TotalTender y CloseFiscalReceipt.
Este comando es rechazado si:
     a. No se encuentra abierto un ticket-factura A; b. La situación frente al IVA del comprador
     no es Responsable no Inscripto. c. No hubo una venta previa dentro del comprobante. d.
     Los montos acumulados fueran a causar un desborde en la capacidad del acumulador del
     total del comprobante.
Comando
 file:///E|/roberto/SERITICK.htm (48 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
                                                                                        No Byte
          Descripción                                                Tipo
               1                 STX
               2                 SN
               3                 61H
               4                 FS
         5-14                     Monto ([+]nnnnnn.nn)                            N
             15                  ETX
       16-19                      BCC
Respuesta
                                                                                        No Byte
        Descripción                                                 Tipo
               1                 STX
               2                 SN
               3                 61H
               4                 FS
            5-8                   Status de la impresora                          H
               9                 FS
       10-13                      Status Fiscal                                        H
             14                  ETX
       15-18                      BCC
3.5.8. Perceptions - Percepciones
Responde:
     a. Imprimiendo al final del ticket una línea dividida en tres campos: descripción de la
     percepción (típicamente, percepciones a aplicar sobre los montos netos sin IVA), alícuota
     del IVA correspondiente a los items sobre los que se aplicará la percepción, y monto a
     aplicar; b. Sumando en memoria el monto resultante en un acumulador especial.
Opciones
     a. Si se llenan los bytes 5-9 con un valor numérico, éste representa al IVA
     correspondiente a los items a los que se aplica el monto de los bytes 38-42.
     b. Si se llenan los bytes 5-9 con asteriscos, el monto de los bytes 38-42 se aplica sobre la
     totalidad de los items vendidos y se reparte proporcionalmente entre los items existentes
     en el comprobante. Una vez emitido el comando en estas condiciones, no puede volver a
     repetírselo, aunque sí puede procederse a la inversa, es decir, emitir primero el comando
 file:///E|/roberto/SERITICK.htm (49 of 101) [8/8/01 15:07:22]
  Impresora Fiscal
      con un valor numérico en los bytes 5-9 y a continuación emitirlo con asteriscos.
Este comando es rechazado si:
      a. No se encuentra abierto un ticket-factura A; b. No hubo una venta previa dentro del
      comprobante con la misma alícuota de IVA que la percepción. c. El total del IVA y/o
      impuestos internos es negativo. d. Los montos acumulados fueran a causar un desborde
      en la capacidad del acumulador del total.
Una vez emitido este comando, no puede proseguirse con la venta, quedando solamente
habilitados los comandos, ChargeNonRegisteredTax, TotalTender y CloseFiscalReceipt y
la repetición del comando Perceptions..
Comando
                                                                                               No Byte
           Descripción                                                      Tipo
                1                 STX
                2                 SN
                3                 60H
                  4                 FS
             5-9                   Alícuota IVA (nn.nn / **.**)                             A
              10                  FS
        11-30                      Hasta 20 caracteres de texto descripción            A
              31                  FS
        38-47                      Monto ([+]nnnnnn.nn)                                   N
              48                  ETX
        49-52                      BCC
                                                                (Respuesta en la página siguiente)
Respuesta
                                                                                               No Byte
         Descripción                                                       Tipo
                1                 STX
                2                 SN
                3                 60H
                4                 FS
             5-8                   Status de la impresora                                H
                9                 FS
  file:///E|/roberto/SERITICK.htm (50 of 101) [8/8/01 15:07:22]
 Impresora Fiscal
       10-13                      Status Fiscal                                         H
             14                  ETX
       15-18                      BCC
3.5.9. Subtotal
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra. Sólo se encuentra operativo durante la emisión de tickets.
Responde:
     a. Calculando el subtotal del ticket abierto y enviándolo a través de la línea serie; b. Si el
     byte numero 5 se llena con el caracter P, imprimiendo la palabra “Subtot”, seguida del
     monto (excepto en el caso de ticket-factura, en el que el subtotal no se imprime nunca,
     cualquiera sea el valor del byte 5). Si el comando se emite a continuación del comando
     Total/Tender, la palabra “Subtot” y el monto no se imprimen, cualquiera sea el caracter del
     byte 5 (pero igual se envía el monto ya pagado por la línea serie).
Nota:
El subtotal no se imprime nunca (aunque los datos igual se envían por el canal del host) si se
encuentra abierto un ticket-factura.
No modifica la memoria de trabajo.
Comando
                                                                                         No Byte
        Descripción                                                        Tipo
               1                 STX
               2                 SN
               3                 43H
               4                 FS
               5                 P: imprimir texto y monto; otro: no imprimir.    A
               6                 FS
         7-31                     Reservado (llenar con un caracter cualquiera) A
             32                  FS
             33                  Parámetro display (sólo operativo en modelo
                                SMH/P-615F; en el resto de los modelos colocar
                                cualquiera de los tres valores)
                                     0: No modifica
                                     1: Escribe display
                                     2: Aumenta subcampo repeticiones            N
             34                  ETX
 file:///E|/roberto/SERITICK.htm (51 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
        35-38                      BCC
                                                                (Respuesta en página siguiente)
Respuesta
                                                                                                     No Byte
         Descripción                                                            Tipo
                1                 STX
                2                 SN
                3                 43H
                4                 FS
             5-8                   Status de la impresora                                       H
                9                 FS
        10-13                      Status Fiscal                                                    H
              14                  FS
        15-20                      Cantidad de items vendidos                                    N
              21                  FS
        22-34                      Monto ventas                                                   N
              35                  FS
        36-48                      Monto IVA                                                        N
              49                  FS
        50-62                      Monto pagado (solo tras un pago parcial)                   N
              63                  FS
        64-76                      IVA correspondiente a responsable no inscripto              N
              77                  ETX
      78-81                    BCC
3.5.9. TotalTender - Total
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Responde:
      Calculando el total, registrando el monto pagado, calculando el vuelto e imprimiendo estos
      datos. Alternativamente, cancela el ticket abierto.
Este comando sólo puede emitirse hasta un máximo de cuatro veces seguidas en el caso de
tickets y de seis veces seguidas en el caso de tickets factura. Si, a la cuarta o sexta vez,
respectivamente, que es emitido, el monto pagado no alcanza para cubrir el saldo adeudado,
el comando es rechazado. Para salir de ese estado se debe ingresar un monto que cubra el
saldo adeudado.
Opciones
      Cancelación: Byte número 50: C
         El comando cancela el comprobante fiscal abierto.
  file:///E|/roberto/SERITICK.htm (52 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
     Vuelto: Byte número 50: T
        El comando calcula el vuelto a partir del monto pagado (bytes 36-48), e imprime monto
        pagado y vuelto. Las palabras “Total” y “Cambio” son impresas en forma automática. Una
        vez cumplida esta operación, sólo puede cerrarse el ticket o programarse la cola del
        mismo.
     Pagos parciales:
        Si el monto almacenado en los bytes 36-48 es menor que el total del ticket, sólo se
        imprime el monto pagado, precedido del texto de los bytes 5-34. El comando puede
        volver a emitirse hasta tres veces más en los tickets y hasta cinco veces más en los
        tickets-factura, y el comprobante no podrá cerrarse hasta que el total de los montos
        parciales sea mayor o igual al total del ticket (en ese momento el comando actúa como
        se describe en el párrafo anterior). En este estado, el ticket no puede ser cancelado.
     Cancelación de pagos parciales:
        Si el monto ingresado en los bytes 36-48 es negativo, dicho valor se usa para cancelar
        pagos parciales.
Este comando es rechazado si:
        a. No se encuentra abierto un comprobante fiscal; b. Si va a causar un desborde en los
        acumuladores; c. Si el total es cero; d. Si el total del monto y/o IVA y/o impuestos
        internos es negativo. e. Si se intenta cancelar un ticket luego de haber realizado un pago
        parcial o total.
                                                                 (Comando en la página siguiente)
Comando
                                                                                            No Byte
        Descripción                                                     Tipo
               1                 STX
               2                 SN
               3                 44H
               4                 FS
         5-34                     Texto de hasta 30 caracteres                .     A
             35                  FS
       36-48                      Monto pagado                                          N
             49                  FS
             50                  C: cancela; T: vuelto                                   A
             51                  FS
             52                  Parámetro display (sólo operativo en modelo
                                SMH/P-615F; en el resto de los modelos colocar
                                cualquiera de los tres valores)
                                     0: No modifica
                                     1: Escribe display
 file:///E|/roberto/SERITICK.htm (53 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
                                     2: Aumenta subcampo repeticiones               N
             53                  ETX
       54-57                      BCC
Respuesta
                                                                                          No Byte
        Descripción                                                            Tipo
               1                 STX
               2                 SN
               3                 44H
               4                 FS
            5-8                   Status de la impresora                              H
               9                 FS
       10-13                      Status Fiscal                                         H
             14                  FS
       15-27                      Vuelto o Monto faltante (±nnnnnnnnn.nn)            N
                                                (+: monto faltante; –: vuelto)
             28                  ETX
       29-32                      BCC
3.5.10. CloseFiscalReceipt - Cerrar comprobante fiscal
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Si aún no se ha emitido el comando Total/Tender responde:
     a. Calculando el total, ingresando como monto pagado el total de los vendido (de manera
     que el vuelto es igual a $0.00), e imprimiendo estos valores (estas operaciones son las
     mismas que realiza el comando Total/Tender). b. Cerrando el comprobante fiscal; c.
     Acumulando los montos en la memoria de trabajo; d. Imprimiendo el trailer del
     comprobante; e.Imprimiendo el logotipo fiscal y el número de registro del controlador
     fiscal; f. Alimentando el papel de tickets y cortándolo. g. Imprimiendo el nombre de
     fantasía, la razón social y el número de CUIT en el encabezamiento del siguiente ticket.
Si ya se ha emitido el comando Total/Tender, responde:
     a. Cerrando el comprobante fiscal; b. Acumulando los montos en la memoria de trabajo; c.
     Imprimiendo el trailer del comprobante; d.Imprimiendo el logotipo fiscal y el número de
     registro del controlador fiscal; e. Alimentando el papel de tickets y cortándolo. f.
 file:///E|/roberto/SERITICK.htm (54 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
     Imprimiendo el nombre de fantasía, la razón social y el número de CUIT en el
     encabezamiento del siguiente ticket.
Este comando es rechazado si:
     a. No se encuentra abierto un comprobante fiscal; b. Si va a causar un desborde en los
     acumuladores. c. Si el total del monto vendido es cero; d. Si el total del monto y/o IVA y/o
     impuestos internos es negativo.
Comando
                                                                                       No Byte
        Descripción                                                     Tipo
               1                 STX
               2                 SN
               3                 45H
               4                 ETX
            5-8                   BCC
Respuesta
                                                                                       No Byte
        Descripción                                                     Tipo
               1                 STX
               2                 SN
               3                 45H
               4                 FS
            5-8                   Status de la impresora                          H
               9                 FS
       10-13                      Status Fiscal                                       H
             14                  FS
       15-22                      Número del comprobante fiscal recién emitido N
             23                  ETX
       24-27                      BCC
3.6. Comandos de comprobante no-fiscal
3.6.1. OpenNonFiscalReceipt - Abrir comprobante no-fiscal
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
 file:///E|/roberto/SERITICK.htm (55 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
Responde:
     a. Abriendo un comprobante no-fiscal; b. Imprimiendo, en la impresora de tickets, el
     encabezamiento (excepto la razón social y el número de CUIT, que ya se encuentran
     impresos), que incluye la leyenda “NO FISCAL”.
Este comando es rechazado si ya se encuentra abierto un comprobante fiscal o no-fiscal.
Comando
                                                                                     No Byte
        Descripción                                             Tipo
               1                 STX
               2                 SN
               3                 48H
               4                 ETX
            5-8                   BCC
Respuesta
                                                                                     No Byte
        Descripción                                             Tipo
               1                 STX
               2                 SN
               3                 48H
               4                 FS
            5-8                   Status de la impresora                      H
               9                 FS
       10-13                      Status Fiscal                                     H
             14                  ETX
       15-18                      BCC
3.6.2. OpenNonFiscalSlip - Abrir comprobante no-fiscal en impresora slip
Este comando no se encuentra disponible en el modelo SMH/P-615F.
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Responde:
     a. Abriendo un comprobante no-fiscal en la impresora slip; b. Imprimiendo, en la
     impresora slip, el encabezamiento (excepto la razón social y el número de CUIT, que ya
     se encuentran impresos), que incluye la leyenda “NO FISCAL”.
 file:///E|/roberto/SERITICK.htm (56 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
La operación es: 1. Se emite el comando; 2. Se coloca el papel en la impresora slip; 3. La
impresora toma automáticamente la hoja e imprime el encabezado; 4. Se continúa como si se
tratase de un ticket no fiscal normal. 5. Una vez cerrado el comprobante, la leyenda
“Comprobante no fiscal emitido en tercera estación” se imprime en la cinta de auditoría.
Este comando es rechazado si ya se encuentra abierto un comprobante fiscal o no-fiscal.
Comando
                                                                                    No Byte
         Descripción                                            Tipo
                1                 STX
                2                 SN
                3                 47H
                4                 ETX
             5-6                   BCC                                            N
Respuesta
                                                                                    No Byte
         Descripción                                            Tipo
                1                 STX
                2                 SN
                3                 47H
                4                 FS
             5-8                   Status de la impresora                      H
                9                 FS
        10-13                      Status Fiscal                                   H
              14                  ETX
        15-18                      BCC
3.6.3. PrintNonFiscalText - Imprimir texto no-fiscal
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Responde imprimiendo un texto con una longitud máxima de 80 caracteres. En un
documento no-fiscal emitido mediante la impresora de tickets sólo se imprimen los 40
promeros caracteres; en uno emitido mediante la impresora slip, se imprimen los 80
caracteres. (La impresora slip no se encuentra disponible en el modelo SMH/P-615F.)
  file:///E|/roberto/SERITICK.htm (57 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
Este comando es rechazado si no se encuentra abierto un comprobante no-fiscal.
El comando se puede repetir cuantas veces se desee, pero cada cuatro líneas
se intercalará automáticamente la leyenda “NO FISCAL”.
Comando
                                                                                    No Byte
        Descripción                                                     Tipo
               1                 STX
               2                 SN
               3                 49H
               4                 FS
         5-44                     Hasta 80 caracteres de texto                   A
             45                  FS
             46                  Parámetro display (sólo operativo en modelo
                                SMH/P-615F; en el resto de los modelos colocar
                                cualquiera de los tres valores)
                                     0: No modifica
                                     1: Escribe display
                                     2: Aumenta subcampo repeticiones          N
             47                  ETX
       48-51                      BCC
Respuesta
                                                                                    No Byte
        Descripción                                                     Tipo
               1                 STX
               2                 SN
               3                 49H
               4                 FS
            5-8                   Status de la impresora                         H
               9                 FS
       10-13                      Status Fiscal                                    H
             14                  ETX
       15-18                      BCC
3.6.4. CloseNonFiscalReceipt - Cerrar comprobante no-fiscal
 file:///E|/roberto/SERITICK.htm (58 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Responde:
     a. Cerrando el comprobante no-fiscal; b. Imprimiendo el trailer del comprobante
     (incluyendo la leyenda “NO FISCAL” cada 4 líneas). c. Avanzando el papel de tickets y
     cortándolo. d. Imprimiendo el nombre de fantasía, la razón social y el número de CUIT en
     el encabezamiento del siguiente ticket.
Este comando es rechazado si no se encuentra abierto un comprobante no-fiscal.
Cambia el estado del controlador fiscal.
Comando
                                                                                     No Byte
        Descripción                                             Tipo
               1                 STX
               2                 SN
               3                 4aH
               4                 ETX
            5-8                   BCC
Respuesta
                                                                                     No Byte
        Descripción                                             Tipo
               1                 STX
               2                 SN
               3                 4aH
               4                 FS
            5-8                   Status de la impresora                       H
               9                 FS
       10-13                      Status Fiscal                                     H
             14                  ETX
       15-18                      BCC
3.6.5. CutNonFiscalReceipt - Cortar combrobante no-fiscal
Responde avanzando el papel de tickets y cortándolo mientras un comprobante no-fiscal se
encuentra abierto. El tipo de corte es el determinado por los comandos
ConfigureControllerByBlock o ConfigureControllerByOne.
Este comando es rechazado si no se encuentra abierto un comprobante no-fiscal.
 file:///E|/roberto/SERITICK.htm (59 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
Comando
                                                                                No Byte
         Descripción                                            Tipo
                1                 STX
                2                 SN
                3                 4bH
                4                 ETX
             5-8                   BCC
Respuesta
                                                                                No Byte
         Descripción                                            Tipo
                1                 STX
                2                 SN
                3                 4bH
                4                 FS
             5-8                   Status de la impresora                 H
                9                 FS
        10-13                      Status Fiscal                               H
              14                  ETX
        15-18                      BCC
3.6.6. DNFHFarmacias - Documento no fiscal homologado farmacias
Responde imprimiendo un documento no fiscal homologado para uso de Obras Sociales
farmacias con la información del comprobante fiscal anterior.
Este comando sólo puede emitirse inmediatamente después de cerrado un ticket o un ticket-
factura B o C.
Nota:
La cola del documento no fiscal homologado son las tres líneas numeradas 11, 12 y 13 de la
estructura TRAILER (ver comando SetHeaderTrailer).
Comando
                                                                                No Byte
         Descripción                                            Tipo
                1                 STX
  file:///E|/roberto/SERITICK.htm (60 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
                2                 SN
                3                 68H
                4                 FS
                5                 Cantidad ejemplares a imprimir (máximo: 2)  N
                6                 ETX
          7-10                     BCC
Respuesta
                                                                                  No Byte
         Descripción                                                     Tipo
                1                 STX
                2                 SN
                3                 48H
                4                 FS
             5-8                   Status de la impresora                      H
                9                 FS
        10-13                      Status Fiscal                                 H
              14                  ETX
        15-18                      BCC
3.6.7. DNFHReparto - Documento no fiscal homologado reparto
Responde imprimiendo un documento no fiscal con la lista de los ítems vendidos en el
comprobante anterior.
Este comando sólo puede emitirse inmediatamente después de cerrado un ticket o un ticket-
factura B o C.
Nota:
La cola del documento no fiscal homologado son las tres líneas numeradas 11, 12 y 13 de la
estructura TRAILER (ver comando SetHeaderTrailer).
Comando
                                                                                  No Byte
         Descripción                                                    Tipo
                1                 STX
                2                 SN
                3                 69H
                4                 FS
  file:///E|/roberto/SERITICK.htm (61 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
               5                 Cantidad ejemplares a imprimir (máximo: 3)       N
               6                 ETX
         7-10                     BCC
Respuesta
                                                                                       No Byte
        Descripción                                                       Tipo
               1                 STX
               2                 SN
               3                 69H
               4                 FS
            5-8                   Status de la impresora                           H
               9                 FS
       10-13                      Status Fiscal                                       H
             14                  ETX
       15-18                      BCC
3.6.8. SetVoucherData1 - Datos del voucher de tarjeta de crédito 1
Responde almacenando en memoria datos correspondientes a un voucher de tarjeta de
crédito.
Comando
                                                                                       No Byte
        Descripción                                                       Tipo
               1                 STX
               2                 SN
               3                 6aH
               4                 FS
         5-34                     Nombre del cliente (hasta 30 caracteres)        A
             35                  FS
       36-55                      Nombre tarjeta de crédito (hasta 20 caracteres)  A
             56                  FS
             57                  Calificador de operación                           A
                                     C: compra
                                     V: anulación compra
                                     D: devolución
                                      A: anulación devolución
 file:///E|/roberto/SERITICK.htm (62 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
             58                  FS
       59-74                      Número de tarjeta (16 dígitos)              N
             75                  FS
       76-79                      Fecha vencimiento tarjeta (AAMM)         A
             80                  FS
             81                  Tipo de tarjeta usada                      A
                                     D: débito
                                     C: crédito
       82-83                      Cantidad de cuotas (2 dígitos)             N
             84                  ETX
       85-88                      BCC
Respuesta
                                                                                 No Byte
        Descripción                                                Tipo
               1                 STX
               2                 SN
               3                 6aH
               4                 FS
            5-8                   Status de la impresora                     H
               9                 FS
       10-13                      Status Fiscal                                 H
             14                  ETX
       15-18                      BCC
3.6.9. SetVoucherData2 - Datos del voucher de tarjeta de crédito 2
Responde almacenando en memoria datos correspondientes a un voucher de tarjeta de
crédito.
Nota:
El número de comprobante fiscal que debe ir en los bytes 65-72 es el del comprobante que
dio origen a la emisión del voucher.
Comando
                                                                                 No Byte
        Descripción                                                Tipo
 file:///E|/roberto/SERITICK.htm (63 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
               1                 STX
               2                 SN
               3                 6bH
               4                 FS
         5-19                     Código de comercio (hasta 15 dígitos)                  N
             20                  FS
       21-28                      Número de terminal (hasta 8 dígitos)                      N
             29                  FS
       30-32                      Número de lote (hasta 3 dígitos)                       N
             33                  FS
       34-37                      Número de cupón (hasta 4 dígitos)                      N
             38                  FS
             39                  Ingreso de datos tarjeta                                     A
                                     * (asterisco): manual
                                     <SP> (espacio): automática
             40                  FS
             41                  Tipo de operación                                            A
                                     N: on line
                                     F: off line
       42-47                      Número de autorización (hasta 6 dígitos)               N
             48                  FS
       49-63                      Importe                                                    A
                                     (hasta 15 caracteres, incluyendo signo monetario)
             64                  FS
       65-72                      Número de comprobante fiscal (8 dígitos)                N
             73                  ETX
       74-77                      BCC
                                                         (Respuesta en página siguiente)
Respuesta
                                                                                                No Byte
        Descripción                                                               Tipo
               1                 STX
               2                 SN
               3                 6bH
               4                 FS
            5-8                   Status de la impresora                                   H
               9                 FS
 file:///E|/roberto/SERITICK.htm (64 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
        10-13                      Status Fiscal                                 H
              14                  ETX
        15-18                      BCC
3.6.10. PrintVoucher - Imprimir voucher
Responde imprimiendo un voucher de tarjeta de crédito con los datos ingresados mediante
los comandos SetVoucherData1 y SetVoucherData2.
Este comando no puede emitirse si se encuentra abierto un documento.
Nota:
La cola del voucher son las tres líneas numeradas 11, 12 y 13 de la estructura TRAILER (ver
comando SetHeaderTrailer).
Comando
                                                                                  No Byte
         Descripción                                                    Tipo
                1                 STX
                2                 SN
                3                 6cH
                4                 FS
                5                 Cantidad ejemplares a imprimir (máximo: 3) N
                6                 ETX
          7-10                     BCC
Respuesta
                                                                                  No Byte
         Descripción                                                    Tipo
                1                 STX
                2                 SN
                3                 6cH
                4                 FS
             5-8                   Status de la impresora                     H
                9                 FS
        10-13                      Status Fiscal                                 H
              14                  ETX
        15-18                      BCC
  file:///E|/roberto/SERITICK.htm (65 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
3.7. Comando de código de barras
3.7.1 BarCode - Código de barras
Este comando no se encuentra disponible en el modelo SMH/P-615F.
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Responde almacenando los datos de un código de barras y posteriormente imprimiéndolo
automáticamente.
El código de barras puede programarse sólo en las siguientes condiciones:
a. Antes de abrir un comprobante fiscal; b. Luego de haberse realizado los pagos de un
comprobante fiscal (es decir, tras la línea que lleva la palabra CAMBIO) y antes del cierre del
comprobante; c. En medio de un comprobante no fiscal.
Excepto los arriba mencionados, el código de barras no puede programarse en otros estados
del controlador fiscal.
Anulación:
La programación del código de barras queda anulada (y en consecuencia se lo borra de
memoria) si se lo programa antes de abrir un comprobante fiscal pero a continuación se
ejecuta alguno de los siguientes comandos: DailyClose, DailyCloseByDates,
DailyCloseByNumbers o SetDate.
Variantes:
Byte 5: según el tipo de codigo de barras que se desee programar, el byte 5 debe llenarse
con uno de los siguientes valores numéricos:
     1: EAN 13
     2: EAN 8
     3: UPCA
     4: ITS 2 de 5
Byte 7 y siguientes:
Según el tipo de codigo de barras que se desee programar, la cantidad de caracteres
numéricos que deben ingresarse a partir del byte 7 son:
     EAN 13: 12 caracteres numéricos
     EAN 8: 7 caracteres numéricos
     UPCA: 11 caracteres numéricos
     ITS 2 de 5: siempre cantidad par, hasta 16 caracteres numéricos
En los cuatro casos la cantidad de caracteres numéricos debe ser exacta; de no ser así el
comando es rechazado.
Byte 20:
Si se llena este byte con el caracter N, bajo el código de barras se imprime el número
correspondiente. Si se lo llena con cualquier otro caracter, se imprime el código de barras
 file:///E|/roberto/SERITICK.htm (66 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
solamente.
Byte 22:
Si se llena este byte con el caracter P, el código de barras es impreso inmediatamente
después de ingresado el comando (esto sólo es posible en medio de un documento no fiscal
o luego de realizados los pagos de un documento fiscal). Si se lo llena con cualquier otro
caracter, es impreso inmediatamente antes del logotipo fiscal.
                                                               (Comando en la página siguiente)
Comando
                                                                                             No Byte
        Descripción                                                     Tipo
               1                 STX
               2                 SN
               3                 5aH
               4                 FS
               5                 1: EAN 13; 2: EAN 8; 3: UPCA                           N
               6                 FS
7-13/17/18/22                  Datos EAN 8 / UPCA / EAN 13 / ITS 2 de 5             N
             23                  FS
             24                  N: imprime números; otro: no imprime números          A
             25                  FS
             26                  P: imprime en el momento;
                                otro: imprime al final del comprobante               A
             27                  ETX
       28-31                      BCC
Respuesta
                                                                                             No Byte
        Descripción                                                     Tipo
               1                 STX
               2                 SN
               3                 5aH
               4                 FS
            5-8                   Status de la impresora                                H
               9                 FS
       10-13                      Status Fiscal                                             H
             14                  ETX
 file:///E|/roberto/SERITICK.htm (67 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
        15-18                      BCC
3.8. Comandos de control de la impresora
3.8.1 FeedReceipt - Avanzar papel de tickets
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Responde avanzando el papel de tickets tantas líneas como se indica en los bytes 5-6.
En el modelo SMH/P-615F este comando avanza tanto el papel de auditoría como el de
tickets.
Comando
                                                                                   No Byte
         Descripción                                            Tipo
                1                 STX
                2                 SN
                3                 50H
                4                 FS
             5-6                   Cantidad de líneas a avanzar            N
                7                 ETX
          8-11                     BCC
Respuesta
                                                                                   No Byte
         Descripción                                            Tipo
                1                 STX
                2                 SN
                3                 50H
                4                 FS
             5-8                   Status de la impresora                    H
                9                 FS
        10-13                      Status Fiscal                                  H
              14                  ETX
        15-18                      BCC
3.8.2 FeedJournal - Avanzar papel cinta de auditoría
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
  file:///E|/roberto/SERITICK.htm (68 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
estado fiscal en que se encuentra
Responde avanzando el papel de la cinta de auditoría tantas líneas como se indica en los
bytes 5-6.
En el modelo SMH/P-615F este comando avanza tanto el papel de auditoría como el de
tickets.
Comando
                                                                                   No Byte
         Descripción                                            Tipo
                1                 STX
                2                 SN
                3                 51H
                4                 FS
             5-6                   Cantidad de líneas a avanzar            N
                7                 ETX
          8-11                     BCC
Respuesta
                                                                                   No Byte
         Descripción                                            Tipo
                1                 STX
                2                 SN
                3                 51H
                4                 FS
             5-8                   Status de la impresora                    H
                9                 FS
        10-13                      Status Fiscal                                  H
              14                  ETX
        15-18                      BCC
3.8.3 FeedReceiptJournal - Avanzar papeles de tickets y cinta de auditoría
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Responde avanzando los papeles de tickets y de cinta de auditoría tantas líneas como se
indica en los bytes 5-6.
Comando
  file:///E|/roberto/SERITICK.htm (69 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
                                                                                      No Byte
         Descripción                                            Tipo
                1                 STX
                2                 SN
                3                 52H
                4                 FS
             5-6                   Cantidad de líneas a avanzar               N
                7                 ETX
          8-11                     BCC
Respuesta
                                                                                      No Byte
         Descripción                                            Tipo
                1                 STX
                2                 SN
                3                 52H
                4                 FS
             5-8                   Status de la impresora                        H
                9                 FS
        10-13                      Status Fiscal                                    H
              14                  ETX
        15-18                      BCC
3.9. Comandos de fecha, hora, encabezamiento y cola de documentos
3.9.1. SetDateTime - Ingresar fecha y hora
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Pone en fecha y hora el reloj de tiempo real. La fecha y la hora del reloj de tiempo real son
impresos en todos los documentos. La fecha es, además, grabada en los registros diarios
cuando se realiza un cierre de jornada fiscal.
Este comando es rechazado si:
a. El formato es incorrecto; b. Inmediatamente antes no se ha realizado un cierre de jornada
fiscal (comando DailyClose).
Comando
  file:///E|/roberto/SERITICK.htm (70 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
                                                                                   No Byte
        Descripción                                            Tipo
               1                 STX
               2                 SN
               3                 58H
               4                 FS
         5-10                     Fecha (formato AAMMDD)                      D
             11                  FS
       12-17                      Hora (formato HHMMSS)                       T
             18                  ETX
       19-22                      BCC
Respuesta
                                                                                   No Byte
        Descripción                                            Tipo
               1                 STX
               2                 SN
               3                 58H
               4                 FS
            5-8                   Status de la impresora                     H
               9                 FS
       10-13                      Status Fiscal                                   H
             14                  ETX
       15-18                      BCC
3.9.2. GetDateTime - Consultar fecha y hora
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Responde con la fecha y la hora del reloj de tiempo real.
Comando
                                                                                   No Byte
        Descripción                                            Tipo
               1                 STX
               2                 SN
               3                 59H
               4                 ETX
 file:///E|/roberto/SERITICK.htm (71 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
            5-8                   BCC
Respuesta
                                                                                         No Byte
        Descripción                                                 Tipo
               1                 STX
               2                 SN
               3                 59H
               4                 FS
            5-8                   Status de la impresora                           H
               9                 FS
       10-13                      Status Fiscal                                         H
             14                  FS
       15-20                      Fecha (Formato AAMMDD)                            D
             21                  FS
       22-27                      Hora (Formato HHMMSS)                             T
             28                  ETX
       29-32                      BCC
3.9.3. SetHeaderTrailer - Programar texto de encabezamiento y cola de tickets y
documentos no fiscales
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Almacena una línea de texto en la estructura HEADER o TRAILER, para ser impresa en el
encabezamiento o la cola de un ticket.
     La estructura HEADER se usa para imprimir la dirección y otros datos relativos al dueño
     del controlador fiscal que se desee hacer figurar en el encabezamiento de un ticket, a
     continuación del CUIT.
     En un ticket, las líneas 1-4 están destinadas a imprimir el domicilio fiscal y el domicilio
     comercial del propietario. Las líneas 5-10 se imprimen a continuación de la leyenda “A
     CONSUMIDOR FINAL”.
     En el caso de un ticket factura, las líneas 1-4 están destinadas a imprimir el domicilio
     fiscal y el domicilio comercial del propietario, las líneas 5-8 están destinadas a otras
     leyendas de interés comercial, y las líneas 9-10 están destinadas al domicilio del
     comprador. Las líneas 1-8 se imprimen en el encabezamiento del ticket-factura, mientras
     que las líneas 9-10 se imprimen a continuación del nombre del comprador.
     La estructura TRAILER se usa para imprimir el nombre del cajero, número de cheque, u
     otros datos que se desee hacer figurar en la cola del comprobante, luego del cambio y
 file:///E|/roberto/SERITICK.htm (72 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
     antes del No de Registro y del logotipo fiscal.
     Nota: Los datos que corresponden al encabezamiento y cola de un ticket que se
     encuentran almacenados en memoria fiscal (Razón social, CUIT, No de Registro, No de
     PV), más los números de comprobante fiscal, logotipo fiscal, etc., son impresos
     automáticamente, sin intervención del presente comando.
Comando
                                                                                              No Byte
        Descripción                                                       Tipo
               1                 STX
               2                 SN
               3                 5dH
               4                 FS
            5-7                   No de línea de encabezamiento (1-10) o cola (11-20) N
               8                 FS
         9-48                     Texto de hasta 40 caracteres (ver nota)              T
             49                  ETX
       50-53                      BCC
Para borrar una línea de encabezamiento/cola ya ingresada en memoria de trabajo, debe
enviarse un comando con sólo el código ASCII 7fH (DEL) en el campo de texto.
                                                                  (Respuesta en página siguiente)
Respuesta
                                                                                              No Byte
        Descripción                                                       Tipo
               1                 STX
               2                 SN
               3                 5dH
               4                 FS
            5-8                   Status de la impresora                                H
               9                 FS
       10-13                      Status Fiscal                                              H
             14                  ETX
       15-18                      BCC
 file:///E|/roberto/SERITICK.htm (73 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
3.9.4. GetHeaderTrailer - Consultar texto de encabezamiento y cola del ticket
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Envía a través de la línea serie una línea de encabezamiento o de cola de ticket almacenada
en la estructura HEADER o TRAILER.
Comando
                                                                                           No Byte
        Descripción                                                      Tipo
               1                 STX
               2                 SN
               3                 5eH
               4                 FS
            5-9                   No de línea de encabezamiento (1-10) o cola (11-20) N
             10                  ETX
       11-14                      BCC
Respuesta
                                                                                           No Byte
        Descripción                                                      Tipo
               1                 STX
               2                 SN
               3                 5eH
               4                 FS
            5-8                   Status de la impresora                                H
               9                 FS
       10-13                      Status Fiscal                                           H
             14                  FS
       15-54                      Hasta 40 caracteres con el texto almacenado          A
             55                  ETX
       56-59                      BCC
3.9.5. SetCustomerData - Datos comprador ticket-factura
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Responde
 file:///E|/roberto/SERITICK.htm (74 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
      a. Almacenando el nombre, responsabilidad frente al IVA y número de CUIT/documento
      del comprador de un ticket-factura;
      b. Verificando la consistencia interna del CUIT, en caso de ingresárselo.
      c. Verificando la coherencia entre el valor del byte 48 (responsabilidad frente al IVA) y el
      del byte 50 (CUIT o documento), de acuerdo con la siguiente tabla
                 Byte 48                                   Byte 50 (valores admitidos)
                 I/N/A/E/B/M                           C
                 C                                        C / 0 / 1 / 2 / 3 / 4 / <SP> (espacio en blanco)
Los datos ingresados son impresos mediante el comando de apertura de ticket-factura y son
borrados de memoria una vez emitida éste.
Notas:
La dirección del comprador se almacena en las líneas 5 y 6 de la estructra HEADER (ver
comando SetHeaderTrailer).
Si un ticket-factura a consumidor final (byte 48: C) no supera el límite (monto) programado
mediante el comando ConfigureControllerByBlock (valor por defecto $1.000), pueden
llenarse con un espacio los datos correspondientes a nombre y CUIT o documento.
Este comando sólo es aceptado si no se encuentra abierto un comprobante (fiscal o no
fiscal). La no emisión del comando impide abrir un ticket-factura.
                                                                    (Comando en página siguiente)
Comando
                                                                                                           No Byte
         Descripción                                                                   Tipo
                1                 STX
                2                 SN
                3                 62H
                4                 FS
          5-34                     Nombre                                                               A
              35                  FS
        36-46                      CUIT / No documento                                                N
              47                  FS
              48                  Responsabilidad frente al IVA                                        A
                                      I. Responsable inscripto
                                      N: Responsable no inscripto
                                      E: Exento
  file:///E|/roberto/SERITICK.htm (75 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
                                      A: No responsable
                                      C: Consumidor final
                                      B: Resp. no inscripto, venta de bienes de uso
                                      M: Resp. monotributo (no disponible en PR4F)
              49                  FS
              50                       C: CUIT                                        A
                                      0: Libreta de enrolamiento
                                      1: Libreta cívica
                                      2: Documento Nacional de Identidad
                                      3: Pasaporte
                                      4: Cédula de identidad
                                      (espacio en blanco): Sin calificador
              51                  ETX
        52-55                      BCC
Respuesta
                                                                                         No Byte
         Descripción                                                        Tipo
                1                 STX
                2                 SN
                3                 62H
                4                 FS
             5-8                   Status de la impresora                           H
                9                 FS
        10-13                      Status Fiscal                                        H
              14                  ETX
        15-18                      BCC
3.9.6. SetFantasyName - Programar texto del nombre de fantasía del propietario
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra
Almacena en memoria de trabajo una línea de texto de la estructura FANTASY. La estructura
FANTASY consta de dos líneas que se imprimen automáticamente al comienzo del ticket,
inmediatamente antes de la razón social, y son usadas en los casos en los que el nombre
con el que es conocida una empresa no es igual al nombre de la razón social.
  file:///E|/roberto/SERITICK.htm (76 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
Comando
                                                                                    No Byte
        Descripción                                                       Tipo
               1                 STX
               2                 SN
               3                 5fH
               4                 FS
               5                 No de línea del nombre de fantasía (1-2)        N
               6                 FS
         7-46                     Texto de hasta 40 caracteres                 T
             47                  ETX
       48-51                      BCC
Para borrar una línea del nombre de fantasía ya ingresada en memoria de trabajo, debe
enviarse el comando con sólo el código ASCII 7fH (DEL) en el campo de texto.
Respuesta
                                                                                    No Byte
        Descripción                                                       Tipo
               1                 STX
               2                 SN
               3                 5fH
               4                 FS
            5-8                   Status de la impresora                         H
               9                 FS
       10-13                      Status Fiscal                                    H
             14                  ETX
       15-18                      BCC
3.10. Comandos de cajón de dinero
3.10.1 OpenDrawer - Abrir cajón
Chequea el estado de la memoria de trabajo, y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Abre el cajón de dinero conectado a la impresora fiscal.
Comando
 file:///E|/roberto/SERITICK.htm (77 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
                                                                                        No Byte
        Descripción                                                             Tipo
               1                 STX
               2                 SN
               3                 7bH
               4                 ETX
            5-8                   BCC
Respuesta
                                                                                        No Byte
        Descripción                                                             Tipo
               1                 STX
               2                 SN
               3                 7bH
               4                 FS
            5-8                   Status de la impresora                             H
               9                 FS
       10-13                      Status Fiscal                                        H
             14                  ETX
       15-18                      BCC
3.11. Comando de display
Este comando sólo es operativo en el modelo SMH/P-615F, variante con display.
3.11.1. Estructura del display de cliente
El display de cliente que se entrega como dispositivo opcional con el controlador fiscal
SMH/P-615F tiene 2 filas por 20 caracteres, y esta dividido en dos campos.
                                                    Alfanumérico: 16 caracteres
 file:///E|/roberto/SERITICK.htm (78 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
                                                        Numérico: 16 caracteres
Campo alfanumérico: se identifica en el comando mediante la letra L. Tiene 16 caracteres y
se escribe de izquierda a derecha. El texto enviado es escrito previo borrado lo que se
encontraba en el campo. Si se envía un texto de longitud menor a 16 caracteres, éste queda
marginado a la izquierda y los espacios no llenados de la derecha quedan en blanco. Si se
envía un texto de longitud cero, se ejecuta un Clear, borrándose únicamente el campo
alfanumérico del display. Típicamente, es usado por el programa de caja para exhibir la
descripción de un producto.
Campo numérico: se identifica en el comando mediante la letra K. Tiene 16 caracteres y se
escribe de derecha a izquierda. El texto enviado es escrito previo borrado lo que se
encontraba en el campo. Si se envía un texto de longitud menor a 16 caracteres, éste queda
marginado a la derecha y los espacios no llenados de la izquierda quedan en blanco. Si se
envía un texto de longitud cero, se ejecuta un Clear, borrándose únicamente el campo
numérico del display. Típicamente, es usado por el programa de caja para exhibir el precio
del producto descripto en el display alfanumérico.
Los dos campos mencionados arriba aceptan texto alfanumérico.
Campo de repeticiones: Existe un tercer campo auxiliar, el campo de repeticiones,
identificado con la letra N. Ocupa los dos primeros espacios de la izquierda del campo
numérico, sobreescribiéndolos con un número, pero sin borrar el resto del campo numérico.
Típicamente, es usado por el programa de caja como contador de ventas repetidas.
3.11.2. Escritura en el display
La escritura en display se realiza de dos maneras: automática y manual.
      Escritura automática: Al emitirse uno de los comandos PrintFiscalText, PrintLineItem,
      LastItemDiscount, GeneralDiscount, Subtotal, TotalTender o PrintNonFiscalText, y
      de acuerdo a los valores del parámetro de display, se escriben automáticamente los
      siguientes campos:
      Parámetro                 Campos que se escriben
          0                        No modifica el display
          1                        Alfanumérico, numérico
          2                        Incrementa en 1 el campo de las repeticiones
Escritura manual: Debe emitirse el comando WriteDisplay.
  file:///E|/roberto/SERITICK.htm (79 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
3.11.3. WriteDisplay - Escribir en display
Este comando sólo es operativo en el modelo SMH/P-615F, variante con display.
Escribe en alguno de los campos del display de cliente.
Comando
                                                                                    No Byte
        Descripción                                                      Tipo
               1                 STX
               2                 SN
               3                 b2H
               4                 FS
               5                 f                                                A
               6                 Campo sobre el que se escribe                 A
                                     K: escribe en el campo numérico
                                     L: escribe en el campo alfanumérico
                                     N: incrementa en 1 el contador de
                                          repeticiones y exhibe el valor
                                          en el campo de repeticiones
         7-22                     Mensaje a exhibir                              A
             23                  ETX
       24-27                      BCC
Respuesta
                                                                                    No Byte
        Descripción                                                      Tipo
               1                 STX
               2                 SN
               3                 b2H
               4                 FS
            5-8                   Status de la impresora                      H
               9                 FS
       10-13                      Status Fiscal                                    H
             14                  ETX
       15-18                      BCC
 file:///E|/roberto/SERITICK.htm (80 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
3.12. Comandos para uso de la DGI
Estos comandos internos responden a lo especificado en la Resolución General No 4.104 de
la DGI y no se encuentran accesibles al usuario. Se los incluye aquí a título puramente
informativo.
3.12.1. DGICommandProcessor - Procesador de comandos DGI
Chequea el estado de la memoria de trabajo y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Recorre la memoria fiscal y envía por el canal de la DGI el reporte tipo 1 solicitado.
Llama a DGIRequestByDate o DGIRequestByZNumber.
3.12.2. DGIRequestByDate - Reporte de auditoría DGI por fechas
Chequea el estado de la memoria de trabajo, verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Llama al comando DailyCloseByDate.
Envía por el canal DGI los reportes tipo 2 solicitados.
Imprime el reporte global correspondiente.
Una vez impreso el reporte, avanza el papel, lo corta e imprime la razón social y el número
de CUIT en el encabezamiento del siguiente ticket.
3.12.3. DGIRequestByZNumber - Reporte de auditoria DGI por Z
Chequea el estado de la memoria de trabajo y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Llama al comando DailyCloseByNumber
Envía por el canal DGI los reportes tipo 2 solicitados
Imprime el reporte global correspondiente
Una vez impreso el reporte, avanza el papel, lo corta e imprime la razón social y el número
de CUIT en el encabezamiento del siguiente ticket.
  file:///E|/roberto/SERITICK.htm (81 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
3.12.4. KillEprom - Comando de baja del controlador fiscal
Chequea el estado de la memoria de trabajo y verifica si se puede ejecutar el comando en el
estado fiscal en que se encuentra.
Marca un registro en la EPROM fiscal indicando que se le ha dado la baja.
4. Documentos
4.1. Ticket
 file:///E|/roberto/SERITICK.htm (82 of 101) [8/8/01 15:07:23]
Impresora Fiscal
               Línea 1                Estructura
                    Línea 2               Fantasy                    (1)
              Nombre o razón social                           (2)
              Número de CUIT                                     (3)
              Número de Ingresos Brutos                        (4)
               Línea 1
              Línea 2                Estructura                     (5)
              Línea 3                Header
              Línea 4
                    Responsabilidad frente al IVA                  (6)
                 A CONSUMIDOR FINAL                           (7)
               Línea 5
              Línea 6
              Línea 7                Estructura                     (5)
file:///E|/roberto/SERITICK.htm (83 of 101) [8/8/01 15:07:23]
Impresora Fiscal
              Línea 8                Header
              Línea 9
                    Línea 10
              Identificación punto de venta                      (8)
              No correlativo de ticket                         (9)
              Fecha                             Hora              (10)
              Texto fiscal                                        (11)
              Texto fiscal
              Texto fiscal
              Texto fiscal
              Cantidad x precio unitario                        (12)
              Descripción (IVA) Monto                          (13)
              Descripción [IVA] Monto                         (14)
              Descuento [IVA] Monto                            (15)
              Subtot                              Monto            (16)
              TOTAL                                Monto            (17)
              Medio de pago                   Monto            (18)
                    Medio de pago                   Monto
              CAMBIO                          Monto           (19)
               Línea 11
              Línea 12
              Línea 13
              Línea 14
              Línea 15           Estructura
              Línea 16           Trailer                          (20)
              Linea 17
              Línea 18
              Línea 19
              Línea 20
              No controlador fiscal                                 (21)
file:///E|/roberto/SERITICK.htm (84 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
               Logotipo fiscal                                 (22) (continúa en la próxima página)
Notas:
Mientras que en las notas siguientes el punto es utilizado como separador entre miles y la
coma como separador decimal, en los datos ingresados a través de los comandos el
separador entre miles no existe y el separador decimal es el punto.
       (1) En la estructura FANTASY se almacena el nombre de fantasía del propietario. Es
       impresa automáticamente al cerrarse el ticket anterior.
       (2) El nombre o razón social es leído de la EPROM fiscal e impreso automáticamente al
       inicializarse la máquina, desbloqueársela, o luego de cerrarse el ticket anterior.
       (3) El número de CUIT es leído de la EPROM fiscal e impreso automáticamente al
       inicializarse la máquina, desbloqueársela, o luego de cerrarse el ticket anterior.
       (4) El número de Ingresos Brutos es leído de la EPROM fiscal e impreso
       automáticamente (excepto que se haya indicado lo contrario mediante el comando
       ConfigureControllerByBlock o ConfigureControllerByOne) al inicializarse la máquina,
       desbloqueársela, o luego de cerrarse el ticket anterior.
       (5) En la estructura HEADER se almacena la dirección, la responsabilidad frente al IVA y
       otros textos de interés comercial. Es impresa al emitirse el comando OpenFiscalReceipt.
       Los datos se ingresan mediante el comando SetHeaderTrailer.
       (6) La responsabilidad frente al IVA es impresa automáticamenteal emitirse el comando
       OpenFiscalReceipt. Los datos se ingresan mediante el comando SetHeaderTrailer.
       (7) La leyenda “A CONSUMIDOR FINAL” es impresa automáticamente (excepto que se
       haya indicado lo contrario mediante el comando ConfigureControllerByBlock o
       ConfigureControllerByOne) al emitirse el comando OpenFiscalReceipt.
       (8) El número de identificación del punto de venta es leído de la EPROM fiscal y es
       impreso automáticamente al emitirse el comando OpenFiscalReceipt. Va precedido por
       la leyenda “P.V.”.
       (9) El número correlativo de ticket es impreso automáticamente al emitirse el comando
       OpenFiscalReceipt. Va precedido por la leyenda “No. T.”
          (10) La fecha y la hora son impresas automáticamente al emitirse el comando
          OpenFiscalReceipt. La fecha va precedida por la leyenda “FECHA :” y se imprime en
          formato DD-MM-AA. La hora va precedida de la leyenda “HORA :” y se imprime en
          formato HH:MM:SS. La puesta en fecha y hora del reloj de tiempo real se realiza
          mediante el comando SetDateTime.
          (11) El texto fiscal va marginado a la izquierda y puede tener un máximo de 28
          caracteres. Se lo ingresa e imprime mediante el comando PrintFiscalText. Este
          comando puede repetirse hasta dos (modelo 615F) o tres veces (resto de los modelos).
          (12) La cantidad y el precio unitario se ingresan e imprimen (junto con la línea siguiente)
          mediante el comando PrintLineItem. El valor máximo de la cantidad es 999,999, y el
          del precio unitario es 999.999,99 (ver nota siguiente).
          (13) La descripción, el porcentaje correspondiente al IVA y el monto del ítem vendido
          son ingresados e impresos (junto con la línea correspondiente a cantidad y precio
 file:///E|/roberto/SERITICK.htm (85 of 101) [8/8/01 15:07:23]
Impresora Fiscal
         unitario) mediante el comando PrintLineItem. Esta línea está dividida en dos columnas
         o campos, separados por espacios en blanco: el campo de la descripción y el campo
         del monto.
                Campo de la descripción: Comienza a imprimirse desde el margen izquierdo y tiene
                una longitud máxima de 28 caracteres. Se subdivide en dos subcampos: el
                subcampo del texto y el subcampo del IVA.
                     Subcampo del texto: Comienza a imprimirse desde el margen izquierdo y tiene
                     una longitud máxima de 20 caracteres.
                     Subcampo del IVA: Comienza a imprimirse a partir de la columna 22 y tiene un
                     formato de dos enteros y dos decimales, separados por un punto decimal. Se
                     imprime entre paréntesis (ver nota 11).
                Campo del monto: Se imprime marginado a la derecha y puede llegar hasta la
                columna 30. Leído de izquierda a derecha, se inicia con el signo pesos, seguido de
                un espacio y a continuación el monto. El valor máximo del monto unitario de un
                ítem es de seis enteros con dos decimales, separados por un punto decimal. En el
                caso en que el monto que deba imprimirse supere este valor (por haberse vendido
                un ítem en cantidades), el monto se imprimirá sin decimales para no invadir el
                campo de la descripción. Sin embargo, será almacenado en memoria con los
                decimales, de manera que todas las operaciones se realizarán teniéndolos en
                cuenta.
         (14) En los casos en que el IVA esté afectado por un coeficiente de impuestos internos,
         se lo imprime entre corchetes.
         (15) Los descuentos se ingresan mediante el comando PrintLineItem,
         LastItemDiscount o GeneralDiscount y tienen el formato descripto en la nota 13.
         (16) El monto correspondiente al subtotal es calculado e impreso mediante el comando
         Subtotal. La palabra “Subtot” es impresa automáticamente.
         (17) El monto correspondiente al total es calculado e impreso, junto con la línea
         siguiente, mediante el comando TotalTender. La palabra “TOTAL” es impresa
         automáticamente. Toda la línea se imprime en caracteres de doble ancho.
         (18) El monto ingresado como pago y el texto con la descripción del medio de pago
         utilizado son ingresados e impresos (junto con la línea anterior) mediante el comando
         TotalTender. El valor máximo del monto es 999.999.999,99. La longitud máxima de la
         descripción es de 28 caracteres. Sólo se admite hasta un máximo de cuatro líneas
         dedicadas a medios de pago.
         (19) La leyenda “CAMBIO” y el monto del cambio son impresos automáticamente una
         vez que el monto ingresado como pago supere el total del ticket. Toda la línea se
         imprime en caracteres de doble ancho.
         (20) En la estructura TRAILER se almacenan datos de interés del usuario del
         controlador: por ejemplo, nombre del cajero, número de cliente, número de documento
         con el que se paga, etc. Es impresa al emitirse el comando CloseFiscalReceipt. Los
         datos se ingresan mediante el comando SetHeaderTrailer.
         (21) El número del controlador fiscal es leído de la EPROM fiscal y es impreso
file:///E|/roberto/SERITICK.htm (86 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
          automáticamente al emitirse el comando CloseFiscalReceipt.
          (22) El logotipo fiscal es impreso automáticamente al emitirse el comando
          CloseFiscalReceipt.
4.2. Ticket-factura
 file:///E|/roberto/SERITICK.htm (87 of 101) [8/8/01 15:07:23]
Impresora Fiscal
               Línea 1
                    Línea 2               Estructura Fantasy         (1)
              Nombre o razón social                             (2)
              Número de CUIT                                        (3)
               Número de Ingresos Brutos                         (4)
              Línea 1
              Línea 2                Estructura                        (5)
              Línea 3                Header
              Línea 4
                    INICIO DE ACTIVIDADES:                            (6)
                    Responsabilidad frente al IVA                     (7)
                    TIQUE FACTURA “A” P.deV. - No T.                   (8)
                                                          Fecha           (9)
                                                          Hora         (10)
              Nombre comprador                                  (11)
                    CUIT comprador                                  (12)
file:///E|/roberto/SERITICK.htm (88 of 101) [8/8/01 15:07:23]
Impresora Fiscal
                    Resp. frente al IVA comprador                               (13)
                     Línea 9               Estructura
                    Línea 10           Header                                     (5)
               Línea 5
              Línea 6
              Línea 7                Estructura                                  (5)
              Línea 8                Header
              Línea 9
                    Línea 10
              CANT/PR. UNIT. (%IVA)
                    DESCRIPCION                  [%B.I.] IMPORTE            (14)
              Texto fiscal                                                   (15)
              Texto fiscal
              Texto fiscal
              Texto fiscal
              Cant. / precio unit. (IVA)                                  (16)
               Descripción                   [%BI]            Monto        (17)
              Descuento                    [IVA/BI] Monto              (18)
                    Percepción                                  Monto         (19)
                    Percepción general                         Monto       (20)
              NETO SIN IVA                                    Monto      (21)
                    IVA XX.XX%                                   Monto         (22)
                    IVA NO INSCRIPTOS                          Monto        (23)
                    IMPUESTOS INTERNOS                          Monto        (24)
file:///E|/roberto/SERITICK.htm (89 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
               Percepción IVA                                  Monto  (25)
                                                                     (Continúa en la página siguiente)
                TOTAL                                 Monto               (26)
                Medio de pago                   Monto                  (27)
               Medio de pago                   Monto
                Línea 11
               Línea 12           Estructura
               Línea 13           Trailer                                (28)
               Linea 14
               No controlador fiscal                                     (29)
               Logotipo fiscal                                           (30)
Notas:
Mientras que en las notas siguientes el punto es utilizado como separador entre miles y la
coma como separador decimal, en los datos ingresados a través de los comandos el
separador entre miles no existe y el separador decimal es el punto.
       (1) En la estructura FANTASY se almacena el nombre de fantasía del propietario. Es
       impresa automáticamente al cerrarse el ticket anterior.
       (2) El nombre o razón social es leído de la EPROM fiscal e impreso automáticamente al
       inicializarse la máquina, desbloqueársela, o luego de cerrarse el ticket anterior.
       (3) El número de CUIT es leído de la EPROM fiscal e impreso automáticamente al
       inicializarse la máquina, desbloqueársela, o luego de cerrarse el ticket anterior.
       (4) El número de Ingresos Brutos es leído de la EPROM fiscal e impreso
       automáticamente (excepto que se haya indicado lo contrario mediante el comando
 file:///E|/roberto/SERITICK.htm (90 of 101) [8/8/01 15:07:23]
Impresora Fiscal
      ConfigureControllerByBlock o ConfigureControllerByOne) al emitirse el comando
      OpenFiscalReceipt.
      (5) En la estructura HEADER se almacena la dirección de emisor / comprador y otros
      textos de interés comercial. Es impresa al emitirse el comando OpenFiscalReceipt. Los
      datos se ingresan mediante el comando SetHeaderTrailer.
      (6) La fecha de inicio de actividades es leída de la EPROM fiscal e impresa
      automáticamente (precedida por la leyenda “INICIO DE ACTIVIDADES”) al emitirse el
      comando OpenFiscalReceipt.
      (7) La responsabilidad frente al IVA es leída de la EPROM fiscal e impresa
      automáticamente (excepto que se haya indicado lo contrario mediante el comando
      ConfigureControllerByBlock o ConfigureControllerByOne) al emitirse el comando
      OpenFiscalReceipt.
      (8) El tipo de factura (A o B) es impresa automáticamente (precedido por la leyenda
      “TIQUE FACTURA”) al emitirse el comando OpenFiscalReceipt. El número de
      identificación del punto de venta y el número de ticket-factura es leído de la EPROM
      fiscal y es impreso automáticamente al emitirse el comando OpenFiscalReceipt. Va
      precedido por la leyenda “Nro.” y tiene el formato nnnn.nnnnnnnn, donde los cuatro
      números anteriores al punto indican el número de punto de venta y los ocho números
      posteriores indican el número del ticket-factura
      (9) La fecha es impresa automáticamente al emitirse el comando OpenFiscalReceipt. Va
      precedida por la leyenda “FECHA :” y se imprime en formato DD-MM-AA. La puesta en
      fecha del reloj de tiempo real se realiza mediante el comando SetDateTime.
         (10) La hora es impresa automáticamente al emitirse el comando OpenFiscalReceipt.
         Va precedida de la leyenda “HORA :” y se imprime en formato HH:MM:SS. La puesta en
         hora del reloj de tiempo real se realiza mediante el comando SetDateTime.
         (11) El nombre del comprador es impreso automáticamente al emitirse el comando
         OpenFiscalReceipt. El nombre se ingresa mediante el comando SetCustomerData.
         (12) El número de CUIT o de documento del comprador es impreso automáticamente al
         emitirse el comando OpenFiscalReceipt. El número va precedido por una de las
         siguientes leyendas: “C.U.I.T.”, “D.N.I.”, “L.E.”, “L.C.” o “C.I.” y se ingresa mediante el
         comando SetCustomerData.
         (13) La responsabilidad frente al IVA del comprador es impresa automáticamente al
         emitirse el comando OpenFiscalReceipt.
         (14) El encabezamiento de la zona del ticket-factura dedicado a las ventas es impresa
         autómaticamente al emitirse el comando OpenFiscalReceipt. Contiene las leyendas
         “CANTIDAD/PRECIO UNITARIO”, “(%IVA)”, “DESCRIPCION”, “[%B.I.]” e “IMPORTE”.
         (15) El texto fiscal va marginado a la izquierda y puede tener un máximo de 28
         caracteres. Se lo ingresa e imprime mediante el comando PrintFiscalText. Este
         comando puede repetirse hasta tres (modelo 615F) o cuatro veces (resto de los
         modelos).
         (16) La cantidad, el precio neto unitario y la alícuota de IVA se ingresan e imprimen
         (junto con la línea siguiente) mediante el comando PrintLineItem. El valor máximo de la
file:///E|/roberto/SERITICK.htm (91 of 101) [8/8/01 15:07:23]
Impresora Fiscal
         cantidad es 999,999 y el del precio neto unitario es 999.999,99 (ver nota siguiente).
         (17) La descripción, el porcentaje correspondiente al precio base (precio neto +
         impuestos internos) no afectado por impuestos internos (de existir éstos) y el monto del
         ítem vendido son ingresados e impresos (junto con la línea correspondiente a cantidad
         y precio neto unitario) mediante el comando PrintLineItem. Esta línea está dividida en
         dos columnas o campos, separados por espacios en blanco: el campo de la descripción
         y el campo del monto.
                Campo de la descripción: Comienza a imprimirse desde el margen izquierdo y tiene
                una longitud máxima de 28 caracteres. Se subdivide en dos subcampos: el del
                texto y el de la base imponible.
                     Subcampo del texto: Comienza a imprimirse desde el margen izquierdo y tiene
                     una longitud máxima de 20 caracteres.
                     Subcampo de la base imponible: Comienza a imprimirse a partir de la columna
                     22 y tiene un formato de dos enteros y dos decimales, separados por un punto
                     decimal. Se imprime entre corchetes.
                Campo del monto: Se imprime marginado a la derecha y puede llegar hasta la
                columna 30. Leído de izquierda a derecha, se inicia con el signo pesos, seguido de
                un espacio y el monto. El valor máximo del monto unitario de un ítem es de seis
                enteros con dos decimales, separados por un punto decimal. En el caso en que el
                monto que deba imprimirse supere este valor (por haberse vendido un ítem en
                cantidades), el monto se imprimirá sin decimales para no invadir el campo de la
                descripción. Sin embargo, será almacenado en memoria con los decimales, de
                manera que todas las operaciones se realizarán teniéndolos en cuenta.
         (18) Los descuentos se ingresan mediante el comando PrintLineItem,
         LastItemDiscount o GeneralDiscount y tienen el formato descripto en la nota anterior
         y en el Apéndice 5.
         (19) Las percepciones se ingresan mediante el comando Perceptions. Son impresas al
         emitirse el comando TotalTender o CloseFiscalReceipt.
         (20) Las percepciones generales se ingresan mediante el comando Perceptions. Son
         impresas al emitirse el comando TotalTender o CloseFiscalReceipt.
         (21) El monto del valor neto de los productos se imprime automáticamente (precedido
         por la leyenda “NETO SIN IVA”) al emitirse el comando TotalTender o
         CloseFiscalReceipt.
         (22) El monto de cada una de las alícuotas de los productos son impresos
         automáticamente (precedidos de la leyenda “IVA” más la alícuta correspondiente) al
         emitirse el comando TotalTender o CloseFiscalReceipt.
         (23) En caso de corresponder, el monto del IVA cobrado a compradores responsables
         no incriptos se imprime automáticamente (precedido de la leyenda “IVA NO
         INSCRIPTOS”) al emitirse el comando TotalTender o CloseFiscalReceipt.
         (24) El monto de los impuestos internos correspondientes a los productos vendidos se
         imprime automáticamente (precedido de la leyenda “IMPUESTOS INTERNO”) al
         emitirse el comando TotalTender o CloseFiscalReceipt.
file:///E|/roberto/SERITICK.htm (92 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
          (25) El monto total de las percepciones se imprime automáticamente (precedido de la
          leyenda “Percepción IVA”) al emitirse el comando TotalTender o CloseFiscalReceipt.
          (26) El monto correspondiente al total es calculado e impreso, junto con la línea
          siguiente, mediante el comando TotalTender. La palabra “TOTAL” es impresa
          automáticamente. Toda la línea se imprime en caracteres de doble ancho.
          (27) El monto ingresado como pago y el texto con la descripción del medio de pago
          utilizado son ingresados e impresos (junto con la línea anterior) mediante el comando
          TotalTender. El valor máximo del monto es 999.999.999,99. La longitud máxima de la
          descripción es de 28 caracteres. Sólo se admite hasta un máximo de seis líneas
          dedicadas a medios de pago.
          (28) En la estructura TRAILER se almacenan datos de interés del usuario del
          controlador: por ejemplo, nombre del cajero, número de cliente, número de documento
          con el que se paga, etc. En los tickets-factura sólo se imprimen las líneas 11, 12, 13 y
          14. Es impresa al emitirse el comando CloseFiscalReceipt. Los datos se ingresan
          mediante el comando SetHeaderTrailer.
          (29) El número del controlador fiscal es leído de la EPROM fiscal y es impreso
          automáticamente al emitirse el comando CloseFiscalReceipt.
          (30) El logotipo fiscal es impreso automáticamente al emitirse el comando
          CloseFiscalReceipt.
Apéndices
Apéndice 1: Tipo de letra.
En ciertos textos fiscales y no fiscales al comienzo de la línea puede embeberse un comando
que selecciona el tipo de letra en el que se imprimirá la línea.
Los formatos disponibles son
     Normal : Este es el valor por defecto.
     Doble ancho: f4H (ASCII 244)
Estos formatos sólo pueden aplicarse a los comandos:
     41H - Imprimir texto fiscal
     49H - Imprimir texto no-fiscal
     5dH - Programar encabezamiento y cola del ticket
     5fH - Ingresar nombre de fantasía
Al final de cada línea a imprimir se envía a la impresora una secuencia que la coloca en
modo de impresión normal (simple ancho).
Apéndice 2: Status fiscal
 file:///E|/roberto/SERITICK.htm (93 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
Los 16 bits del status fiscal (4 nibbles), expresados en binario, tienen el siguiente significado
(el bit 0 es el menos significativo):
Bit             Descripción
0                1 = Error en chequeo de memoria fiscal.
                           Al encenderse la impresora se produjo un error en el checksum.
                           La impresora no funcionará.
1                1 = Error en chequeo de memoria de trabajo
                           Al encenderse la impresora se produjo un error en el checksum.
                           La impresora no funcionará.
2                Siempre 0.
3                1 = Comando desconocido
                         El comando recibido no fue reconocido.
4                1 = Datos no válidos en un campo
                           Uno de los campos del comando recibido tiene datos no válidos por ejemplo,
                           datos no numéricos en un campo numérico).
5                1 = Comando no válido para el estado fiscal actual
                           Se ha recibido un comando que no es válido en el estado actual del
                           controlador (por ejemplo, abrir un recibo no-fiscal cuando se encuentra
                           abiertor un recibo fiscal).
                           Nota: cuando se ha producido un cambio no válido de código de IVA, tanto el
                           bit 4 como el 5 tendrán valor 1.
6                1 = Desborde del Total
                           El acumulador de una transacción, del total diario o del IVA se desbordará a
                           raíz de un comando recibido.
                           El comando no es ejecutado. Este bit debe ser monitoreado por el host para
                           emitir un aviso de error.
7                1 = Memoria fiscal llena, bloqueada o dada de baja
                           En caso de que la memoria fiscal esté llena, bloqueada o dada de baja, no se
                           permite abrir un comprobante fiscal.
8                1 = Memoria fiscal a punto de llenarse
                           La memoria fiscal tiene 30 o menos registros libres.
                           Este bit debe ser monitoreado por el host para emitir el correspondiente
                           aviso.
9                1 = Terminal fiscal certificada
                         Indica que la impresora ha sido inicializada.
10               1 = Terminal fiscal fiscalizada
                         Indica que la impresora ha sido inicializada.
11               1 = Error en ingreso de fecha
  file:///E|/roberto/SERITICK.htm (94 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
                         Se ha ingresado una fecha no válida.
                         Para volver al bit a 0 debe ingresarse una fecha válida.
12               1 = Recibo fiscal abierto
                           Este bit se encuentra en 1 siempre que un documento fiscal se encuentra
                           abierto.
                                                                (continúa en la página siguiente)
13               1 = Recibo abierto
                           Este bit se encuentra en 1 siempre que un recibo se encuentra abierto.
14               1 = Factura abierta (no aplicable)
15               1 = OR lógico de los bits 0 a 8.
                           Este bit se encuentra en 1 siempre que alguno de los bits mencionados se
                           encuentre en 1.
Apéndice 3: Status impresora
Los 16 bits del status de la impresora (4 nibbles), expresados en binario, tienen el siguiente
significado (el bit 0 es el menos significativo):
Bit             Descripción
0                Siempre 0
1                Siempre 0
2                1 = Error de impresora
                           Se ha interrumpido la conexión entre el controlador fiscal y la impresora.
3                1 = Impresora offline
                           La impresora no ha logrado comunicarse dentro del período de tiempo
                           establecido.
4                1 = Falta papel del diario
                           El sensor de papel del diario ha detectado falta de papel.
5                1 = Falta papel de tickets
                           El sensor de papel de tickets ha detectado falta de papel.
6                1 = Buffer de impresora lleno
                           El controlador fiscal convierte los comandos enviados por un host en
                           comandos fiscales, y los almacena en un buffer antes de enviarlos a la
                           impresora fiscal. Cuando el buffer se aproxima a su capacidad máxima, este
                           bit se activa. Cualquier comando que se envíe cuando este bit está en 1 no
                           se ejecuta y debe ser reenviado por el host.
7                1 = Buffer de impresora vacío
                           Este bit se activa cuando el buffer mencionado en el punto anterior se
  file:///E|/roberto/SERITICK.htm (95 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
                           encuentra vacío. Es una indicación al host de que todos los comandos fueron
                           enviados a la impresora fiscal.
8                1 = Tapa de impresora abierta.
9                Siempre 0.
10               Siempre 0.
11               Siempre 0.
12               Siempre 0.
13               Siempre 0.
14               1 = Cajón de dinero cerrado o ausente.
15               1 = OR lógico de los bits 2-5, 8 y 14.
Este bit se encuentra en 1 siempre que alguno de los bits del 2 al 5, el bit 8 o el 14, se
encuentre en 1.
Apéndice 4: Status auxiliar
El status auxiliar indica el estado del parser del controlador fiscal. Según el valor del nibble
menos significativo, considerado en formato decimal, el controlador se encuentra en uno de
los siguientes estados:
Valor Decimal                  Estado
      0                           Memoria fiscal no formateada.
      1                           Memoria fiscal no inicializada.
      2                           No hay ningún comprobante abierto.
      3                           Un comprobante fiscal se encuentra abierto.
      4                           Comprobante fiscal abierto. Se acaba de imprimir un texto fiscal.
      5                           Un comprobante no fiscal se encuentra abierto.
      6                           Comprobante fiscal abierto. Se realizó al menos un pago.
      7                           Comprobante fiscal abierto. Se saldó el monto.
      8                           Se ha emitido alguno de los comandos de percepciones.
      9                           El controlador ha sido dado de baja.
Además, según el valor del nibble más significativo, considerado en formato decimal, el
controlador se encuentra en uno de los siguientes estados:
Valor Decimal                   Estado
      2                           Datos del comprador (ticket-factura) ingresados
      4                           Código de barras almacenado en memoria de trabajo.
                                    8                           Operando en modo entrenamiento.
      c                           Modo entrenamiento + código de barras almacenado
Apéndice 5: Manejo del IVA
  file:///E|/roberto/SERITICK.htm (96 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
5.1. Estructura de la tabla de IVA
El controlador fiscal cuenta con una tabla de IVA con capacidad para almacenar un máximo
de 10 valores (porcentajes) de IVA. El funcionamiento es el siguiente:
Los 10 valores de la tabla se llenan en forma dinámica. Al inicio de la jornada fiscal las 10
posiciones se encuentran vacías. Al recibir un comando PrintLineItem, y antes de que la
venta quede registrada, el controlador verifica:
     Si ya se ha vendido, en el mismo ticket, un producto con un IVA similar. En caso
     afirmativo la venta es aceptada.
     En caso contrario, verifica:
        Si el IVA del producto a venderse ya se encuentra almacenado en la tabla. En caso
        afirmativo la venta es aceptada.
        En caso contrario, verifica:
                 Si hay espacio disponible en la tabla. En caso afirmativo la venta es aceptada y se
                 llena la primera posición disponible de la tabla con el IVA del producto vendido.
                 En caso contrario, la venta es rechazada.
Al realizarse el de cierre de jornada fiscal mediante el comando DailyClose, todas las
posiciones de la tabla de IVA son puestas a cero.
5.2. Impuestos internos
Para el cálculo del monto del IVA correspondiente a un ítem cuya base imponible ha sido
ajustada de acuerdo a lo previsto en el segundo párrafo del artículo 18 del Deccreto No
2.407/86 y sus modificaciones, se utilizó la siguiente fórmula:
donde
     M = Monto a sumar en el acumulador correspondiente a iva.
     Pv = Precio de venta
     iva = Valor porcentual del IVA expresado en forma decimal.
              k = Coeficiente de impuestos internos = 1/(1+Ii), donde Ii es el valor, expresado en
              forma decimal, del cociente entre impuestos internos y precio base (Ej: Precio base =
              $ 20; Impuesto interno = $ 1. Por lo tanto, Ii = 1/20 = 0,05, y k = 1/(1+0.05) =
              0,9523809).
El subcampo del ticket correspondiente al porcentaje de Base Imponible se imprime entre
corchetes, y lleva un valor que resulta de la multiplicación del coeficiente k por el valor
porcentual del IVA.
En las operaciones de recargo o descuento sobre subtotal, el valor del coeficiente k es
 file:///E|/roberto/SERITICK.htm (97 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
ignorado y se lo considera igual a uno.
5.3. Cálculo del monto del IVA en los recargos o descuentos sobre el subtotal
Cuando se realiza un recargo o un descuento sobre el subtotal en un comprobante de venta
el IVA correspondiente a dicha operación se calcula de la siguiente manera:
      Mj = IVAi × RD / SITEM
donde:
                  Mj = Monto a sumar o restar en el acumulador de IVA correspondiente a la posición
                  j de la tabla de IVA.
                     IVAj = Monto del IVA correspondiente a la posición j de la tabla, acumulado hasta
                     el momento en el ticket.
                  RD = Monto del recargo o descuento realizado.
      SITEM = Monto total de lo vendido hasta el momento en el ticket.
5.4. Impresión de las líneas correspondientes a descuentos (o recargos)
               Nota: En todos los casos de descuentos o recargos, el controlador sólo reconoce
               montos fijos. En caso de que se desee hacer un descuento o recargo porcentual, el
               cálculo del monto fijo que debe enviarse al controlador queda por cuenta del
               programa de caja o facturación.
Las líneas correspondientes a descuentos se imprimen de acuerdo con lo siguiente:
5.4.1. Ticket-factura A
• Descuento sobre último item vendido y venta con signo negativo
      Sin impuestos internos: Se imprime en una sola línea que incluye, entre paréntesis, el
      subcampo del IVA. El valor de éste se corresponde con el del último item vendido o con el
      del item vendido con signo negativo.
      Con impuestos internos: Se imprime en dos líneas. Los valores entre paréntesis (IVA) y
      entre corchetes [%BI] se corresponden con los del útimo item vendido o con los del item
      vendido con signo negativo.
• Descuento general
      Sin impuestos internos: Se imprime en una sola línea. El subcampo correspondiente a
      Base Imponible o a IVA está en blanco.
      Con impuestos internos: Se imprime en una sola línea, que incluye el subcampo
      correspondiente a Base Imponible entre corchetes. El valor de ésta surge de la expresión:
  file:///E|/roberto/SERITICK.htm (98 of 101) [8/8/01 15:07:23]
  Impresora Fiscal
      Σ BI / (Σ BI + Σ Mii)
      donde:
                             Σ BI = Suma de los montos correspondientes a bases imponibles de los
                             items sobre los que se realiza el descuento
                             Σ Mii = Suma de los montos correspondientes a impuestos internos
                             porcentuales de los items sobre los que se realiza el descuento.
5.4.2. Tickets y ticket-facturas B
• Descuento sobre último item vendido y venta con signo negativo
      Sin impuestos internos: Se imprime en una sola línea que incluye, entre paréntesis, el
      subcampo del IVA. El valor de éste se corresponde con el del último item vendido o con el
      del item vendido con signo negativo.
      Con impuestos internos: Se imprime en dos líneas. Los valores entre paréntesis (IVA) y
      entre corchetes [%BI] se corresponden con los del útimo item vendido o con los del item
      vendido con signo negativo.
• Descuento general
      Sin impuestos internos: Se imprime en una sola línea. El subcampo correspondiente a
      Base Imponible o a IVA está en blanco.
      Con impuestos internos: Se imprime en una sola línea, que incluye, entre corchetes, el
      subcampo correspondiente a Base Imponible. El valor de ésta surge de la expresión:
      Σ Miva / (Σ Miva + Σ BI + Σ Mii)
      donde:
                             Σ Miva = Suma de los montos correspondientes a IVAs de los items sobre
                             los que se realiza el descuento.
                             Σ BI = Suma de los montos correspondientes a bases imponibles de los
                             items sobre los que se realiza el descuento
                             Σ Mii = Suma de los montos correspondientes a impuestos internos
                             porcentuales de los items sobre los que se realiza el descuento.
Apéndice 6: Características de la comunicación Host-Controlador fiscal
Comunicación half duplex sobre canal de comunicaciones serie asincrónico. Es decir,
transmisión, recepción y tiempos de expiración por interrupciones.
La características de la comunicación son:
                         Tipo:         RS-232C
  file:///E|/roberto/SERITICK.htm (99 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
                        Modo:         Half duplex
                        Datos:        Palabra de 8 bits, sin paridad, 1 bit de stop
Las características del cableado del host son:
Conector DB9H
                        Pin           Señal                     I/O
                        2             Transmit Data              O
                        3             Receive Data               I
                          5            Signal Ground
Conector DB25H
                        Pin           Señal                     I/O
                        2             Transmit Data              O
                        3             Receive Data               I
                                        7                             Signal Ground
La salida del controlador fiscal tiene el siguiente cableado:
Conector DB9M
                        Pin           Señal
                        2             Printer Receive Data
                        3             Printer Transmit Data
                        5             Signal Ground
Conector DB25M
                        Pin           Señal
                        2             Printer Transmit Data
                        3             Printer Receive Data
                        7             Signal Ground
 file:///E|/roberto/SERITICK.htm (100 of 101) [8/8/01 15:07:23]
 Impresora Fiscal
Los datos intercambiados entre host y controlador fiscal son ASCII y el controlador fiscal
responde sólo al protocolo Xon/Xoff. Como cada comando enviado por el host debe recibir
una respuesta del controlador fiscal, éste nunca enviará control de paso Xoff al host.
 file:///E|/roberto/SERITICK.htm (101 of 101) [8/8/01 15:07:24]
